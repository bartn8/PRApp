\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[margin=50pt]{geometry}
\usepackage{tabularx}
\usepackage{tabulary}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{float}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{svg}
\usepackage[italian]{babel}

\lstset{
tabsize = 4, %% set tab space width
showstringspaces = false, %% prevent space marking in strings, string is defined as the text that is generally printed directly to the console
numbers = left, %% display line numbers on the left
commentstyle = \color{gray}, %% set comment color
keywordstyle = \color{blue}, %% set keyword color
stringstyle = \color{red}, %% set string color
rulecolor = \color{black}, %% set frame color to avoid being affected by text color
basicstyle = \small \ttfamily , %% set listing font and size
breaklines = true, %% enable line breaking
numberstyle = \tiny,
}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
}


\title{Ingegneria del Software T - Gruppo 3}
\author{
    Luca Bartolomei 
    \texttt{0000825005}
    \\
    Luigi di Nuzzo
    \texttt{0000824873}
    \\
    Filippo Veronesi
    \texttt{0000832244}
}

\date{Marzo 2020}

\begin{document}

\newcommand{\mc}[2]{\multicolumn{#1}{>{\setlength{\hsize}{#1\hsize}}X|}{#2}}
\newcommand{\mcc}[2]{\multicolumn{#1}{|l|}{#2}}

\maketitle

\tableofcontents

\newpage

\section{Abstract}

Il progetto riguarda la creazione di un applicativo software gestionale per prevendite elettroniche.\\Abbiamo pensato il software per un gruppo di amici che organizzano feste, con obiettivi cardine l'abbattimento di costi, l'ottimizzazione dell'entrata dei partecipanti all'evento e una semplificazione dei conti di bilancio.\\L'idea di fondo è di utilizzare, come sostitutivo alla prevendita cartacea, un documento digitale in grado di far entrare il cliente dopo relativo check all'entrata.\\Il risparmio economico ottenuto è ovviamente importante in confronto alla vendita tradizionale. Tuttavia bisogna tenere in conto dei problemi tecnologici che si possono verificare durante la vendita e l'entrata: problemi di connessione Internet, incompatibilità dei dispositivi dei clienti, training del personale addetto alle entrate, eccetera.\\Vengono gestiti, oltre alle prevendite e i relativi clienti, anche la pianificazione dell'evento e i vari membri organizzativi, con relativa suddivisione dei ruoli.\\Per facilitare i conti di bilancio è disponibile una sezione in cui è possibile ricavare statistiche sull'andamento dell'evento.

\newpage

\section{Analisi dei requisiti}

\subsection{Requisiti del sistema}

\subsubsection{Requesiti Funzionali}

\begin{itemize}
	
	%--Requisiti di identificazione
	\item \hypertarget{R1F}{R1F} - Gli utenti devono essere identificati tramite username.
	
	%--Requisito di autenticazione
	\item \hypertarget{R2F}{R2F} - Gli utenti sono autenticati tramite credenziali di username e password.
	\item \hypertarget{R3F}{R3F} - L'accesso ad uno staff, da parte di un utente, avviene tramite codice di accesso.	

	%Funzionale/non funzionale
	\item \hypertarget{R4F}{R4F} - La registrazione di utenti è a carico dell'amministratore di sistema.
	\item \hypertarget{R5F}{R5F} - Possibilità di cambiare la password personale dell'utente.
		
	%--Requisiti di Autorizzazione
	\item \hypertarget{R6F}{R6F} - Ogni membro di uno staff può ricoprire dei ruoli: cassiere, PR, amministratore.	
	\item \hypertarget{R7F}{R7F} - Il ruolo di cassiere riguarda la timbratura di prevendite all'ingresso di un evento.
	\item \hypertarget{R8F}{R8F} - Il ruolo di PR riguarda la vendita di prevendite a clienti.
	\item \hypertarget{R9F}{R9F} - Il ruolo di amministratore riguarda la gestione dei membri, degli eventi, delle tipologie di prevendita di un evento e della visualizzazione di tutte statistiche.
	
	%Accesso e creazione di uno staff
	\item \hypertarget{R10F}{R10F} - Ogni utente registrato nel gestionale può diventare membro di uno o più staff. 
	
	%Timbratura (Cassiere)
	\item \hypertarget{R11F}{R11F} - La timbratura di una prevendita valida permette al cliente di entrare all'evento, ovviamente lo staff potrà effettuare ulteriori controlli non previsti dal sistema e decidere di far entrare un cliente.
	
	\item \hypertarget{R12F}{R12F} - Si prevede la generazione di un documento elettronico da consegnare al cliente, associato alla prevendita, per il riconoscimento all'entrata dell'evento.
	
	%Non viene specificata la modalità di consegna: URL, file immagine file testo etc.
	\item \hypertarget{R13F}{R13F} - La vendita di una prevendita elettronica consiste nella consegna al cliente di un documento digitale di qualche forma, associato alla prevendita elettronica venduta.
	
	%Gestione staff (Amministratore)
	\item \hypertarget{R14F/NF}{R14F/NF} - Un amministratore può concedere/revocare i ruoli a qualsiasi membro dello staff. Unico vincolo è che rimanga almeno un amministratore.
	\item \hypertarget{R15F}{R15F} - Possibilità di cambiare il codice di accesso dello staff da parte di un amministratore.
	   
	\item \hypertarget{R16F}{R16F} - Per gestione degli eventi di uno staff si intende la possibilità di vedere gli staff di un evento, di creane uno nuovo e di poter modificare un evento dello staff.
		
	\item \hypertarget{R17F}{R17F} - La gestione delle tipologie di prevedita di un evento indica l'aggiunta, la modifica e la rimozione delle tipologie di prevendita.
	
	%Definizioni
	%-Eventi
	\item \hypertarget{R18F}{R18F} - Un evento è composto da un nome, una descrizione, un periodo temporale di svolgimento e un luogo. 
	\item \hypertarget{R19F}{R19F} - Un evento può essere annullato, anche se ci sono prevendite vendute.
	
	%Tipologia Prevendita
	\item \hypertarget{R20F}{R20F} - Una tipologia di prevendita serve ad associare alla prevendita un prezzo, una descrizione e un periodo di vendita a tutte le prevendite con la stessa tipologia.

	%-Prevendite
	\item \hypertarget{R21F}{R21F} - Una prevendita può essere annullata e/o rimborsata. 
	
	%-Statistiche
	\item \hypertarget{R22F}{R22F} - Le statistiche di un membro sono suddivise per ruolo coperto all'interno dello staff: cassiere o PR.
	
	\item \hypertarget{R23F}{R23F} - Ogni prevedita è nominativa.
	
	\item \hypertarget{R23Fbis}{R23Fbis} - Il software prevede la possibilità di gestire più staff.
	
	%Requisiti rimossi o spostati nell'analisi del rischio ----------------------------------------
	
	%Si deduce dalla precedente
	%\item Il ruolo di amministratore non prevede statistiche personali.
	%\item \hypertarget{R25F}{R25F} - Lo sblocco dell'utente è a carico dell'amministratore di sistema.
	%--Requisiti di scoperta alle intrusioni
	%\item \hypertarget{R10F}{R10F} - Utilizzo di log per monitorare operazioni critiche.

	%--Requisiti di riservatezza
	%\item \hypertarget{R21NFbis}{R21NFbis} - Le password devono essere salvate in modo sicuro.
	
	%Non vuol dire cifrato! Basta un controllo agli accessi.
	%Se salvi in DB ricorda di indicizzare.
	%\item Il log deve essere salvato in modo abbastanza sicuro.
	
	%-----------------------------------------------------------------------------------------------
		
	
	
\end{itemize}

\subsubsection{Requisiti non funzionali}

\begin{itemize}
    \item \hypertarget{R2NF}{R2NF} - La password degli utenti deve essere lunga almeno 8 caratteri.
	\item \hypertarget{R3NF}{R3NF} - Il codice di accesso allo staff deve essere lungo almeno 4 caratteri.
	\item \hypertarget{R4NF}{R4NF} - Ogni utente registrato può creare al massimo uno staff.
	\item \hypertarget{R5NF}{R5NF} - Requisito fondamentale è il basso costo del prodotto software.
	
	\item \hypertarget{R6NF}{R6NF} - I membri non amministratori possono vedere solo le statistiche personali.	
	\item \hypertarget{R7NF}{R7NF} - I membri non amministratori possono solo vedere le tipologie di prevendite associate ad un evento.
	\item \hypertarget{R8NF}{R8NF} - I membri non amministratori possono solo vedere gli eventi dello staff.
	\item \hypertarget{R9NF}{R9NF} - Il periodo di vendita delle prevendite deve essere antecedente il periodo dell'evento.
	\item \hypertarget{R10NF}{R10NF} - Una prevendita annullata e/o rimborsata rimane tale.
	\item \hypertarget{R11NF}{R11NF} - Un evento annullato rimane tale.
	\item \hypertarget{R12NF}{R12NF} - Si prevedono più forme di consegna del documento digitale, per affrontare le eterogeneità.
	\item \hypertarget{R13NF}{R13NF} - La password fornita dall'amministratore di sistema a tempo di registrazione va cambiata immediatamente dopo il login.
	
	%Prevendita
	\item \hypertarget{R14NF}{R14NF} - Ogni prevendita venduta è associata ad una sola tipologia di prevendita.
	\item \hypertarget{R15NF}{R15NF} - La tipologia di prevendita associata non è modificabile.
	
	%Tipologia prevendita
	\item \hypertarget{R16NF}{R16NF} - Il prezzo di una tipologia di prevendita è modificabile solo se non sono state vendute prevendite con quella determinata tipologia.
	
	%--Requisiti di non-ripudiabilità
	\item \hypertarget{R17NF}{R17NF} - Quando un PR vende una prevendita, essa viene associata ad esso.
	\item \hypertarget{R18NF}{R18NF} - Quando un Cassiere timbra una prevendita, essa viene associata ad esso.
	
	%Vendita (PR)
	\item \hypertarget{R19NF}{R19NF} - Prima della vendita il cliente sceglierà una tipologia di prevendita associata all'evento a cui vuole partecipare.
	
	\item \hypertarget{R20NF}{R20NF} - La timbratura può essere fatta solo una volta.
	
	\item \hypertarget{R21NF}{R21NF} - L'interfaccia utente deve garantire velocità d'utilizzo, soprattutto per il cassiere.
	
	\item \hypertarget{R21NFbis}{R21NFbis} - Quando un utente crea uno staff ne diventa membro e amministratore.
	
	%Requisiti rimossi o spostati nell'analisi del rischio ----------------------------------------
	
	%Se si verifica attacco freezing dell'account cambiare username.
	%\item \hypertarget{R2NF}{R2NF} - Il blocco dell'account deve avvenire dopo 3 tentativi
	%\item \hypertarget{R7NF}{R7NF} - Utilizzare uno o più metodi per velocizzare l'autenticazione dell'utente.
	
		%Devo contare i tentativi falliti nel db: nella sessione potrei cancellare i cookie.
	%\item \hypertarget{R16NF}{R16NF} - Bloccare l'account utente dopo troppi tentativi di accesso e notificarlo nei log.
	
	%\item \hypertarget{R17NF}{R17NF} - Ogni ruolo è indipendente.
	%\item \hypertarget{R18NF}{R18NF} - Ogni staff gestito dal software è indipendente.
	
	%Utilizzo https per la cifratura
	%\item \hypertarget{R19NF}{R19NF} - Si richiede una comunicazione sicura.
	
	%Sistema locale senza server remoto tramite server locale + wifi
	%\item \hypertarget{R20NF}{R20NF} - Si richiedono procedure manuali o automatiche per cercare di garantire la disponibilità del servizio.
	
	%Codice della prevendita
	%Prevendita nominativa
	%\item \hypertarget{R21NF}{R21NF} - Si richiedono metodi per evitare la contraffazione delle prevendite.
	
	%Log
	%\item \hypertarget{R22NF}{R22NF} - Prevedere livelli di log per aiutare l'analisi da parte dell'amministratore di sistema.
	
	%-----------------------------------------------------------------------------------------------
\end{itemize}



\newpage

\subsection{Analisi del dominio}

\subsubsection{Glossario}

\begin{table}[ht!]
  \begin{center}
    \begin{tabulary}{1\textwidth}{|c|C|C|}
        \hline
        \textbf{Voce} & \textbf{Definizione} & \textbf{Sinonimi}\\
        \hline
        \hline
		Amministratore di sistema & Utente con privilegi di sistema aggiuntivi. & \\
		\hline
		Privilegio di sistema & Autorizzazione intrinseca concessa ad un amministratore di sistema che riguarda la gestione del software stesso. Non riguarda gli staff. & \\
		\hline
        Staff & Gruppo di utenti con lo scopo di organizzare eventi. & Ente organizzatore. \\
        \hline
        Utente & Persona registrata nel software gestione. & \\
        \hline
		Cliente & Persona che vuole partecipare ad un evento di uno staff. & \\
		\hline
        Membro & Utente che è iscritto ad uno staff. & Organizzatore \\
        \hline
		PR & Membro di uno staff che si occupa della vendita di prevendite. & \\
		\hline
		Cassiere & Membro di uno staff che si occupa dell'entrata dei clienti ad un evento. & \\
		\hline
		Amministratore & Membro di uno staff che si occupa della gestione dello staff stesso. & \\
		\hline
        Ruolo & Autorizzazione che ha il membro all'interno dello staff. & Autorizzazione \\
        \hline
        Evento & Avvenimento registrato dallo staff, per il quale è possibile vendere prevendite e registrare ingressi. & Festa \\
        \hline
        Tipologia Prevendita & Modello associato ad un evento, la quale dà le caratteristiche di prezzo e descrizione alla prevendita venduta. & Tipo Prevendita \\
        \hline
        Prevendita & Biglietto venduto anticipatamente, che consente l'entrata all'evento pagato. & Ticket, Prevendita Elettronica \\
        \hline
		Statistiche & Informazioni di carattere gestionale, riguardo ad un evento o a un membro dello staff. & \\
		\hline
		Documento digitale & Si tratta di una risorsa digitale, consegnata al cliente, che serve a identificare una prevendita venduta. & \\
		\hline
		Operazione & Comando richiesto al software gestionale da parte di un utente. & \\
		\hline
		Login & Operazione per identificare e autenticare un utente. & Accesso utente, Autenticazione \\
		\hline
		Timbratura & Operazione svolta da un cassiere svolta per validare una prevendita di un cliente. & Convalida della prevendita \\
		\hline
		Credenziali & Coppia di valori username e password utilizzata per l'autenticazione dell'utente. & \\
		\hline
		Username & Stringa di caratteri alfanumerici. Serve a identificare l'utente & \\
		\hline
		Password & String di caratteri alfanumerici. Può contenere caratteri speciali. & \\
		\hline
		Periodo di vendita & Periodo temporale in cui la prevendita è vendibile ai clienti. & \\
		\hline
		Anullamento Prevendita & Operazione che consiste nell'annullare una prevendita acquistata da un cliente. & \\
		\hline
		Rimborso Prevendita & Operazione eseguita su una prevendita annullata, al fine di tenere traccia del conto economico dello staff. & \\
		\hline
		Annullamento Evento & Operazione eseguita da un amministratore quando decide di annullare l'evento. & \\
		\hline
		%Log & Registro dove vengono salvate informazioni per risalire ad operazioni critiche svolte. Composto da una serie di voci & Registro \\
		%\hline
		%Voce di log & Si tratta di una riga del log. & Record del log\\
		%\hline
    \end{tabulary}
  \end{center}
\end{table}

\newpage

\subsection{Analisi dei requisiti}
\subsubsection{Casi d'uso}

%Specificare i casi d'uso?
%Gestione utente: Sblocco utente, Registrazione utente
%Gestione Log: leggi Log, aggiungi log, cancella log
%Gestione vendita prevendita: aggiungi prevendita, annulla prevendita
%Gestione entrata: timbra entrata, leggi prevendita,
%Gestione eventi: aggiungi evento, modifica evento, annulla evento
%Gestione tipologie prevendite: aggiungi tipologia prevendita, modifica tipologia prevendita, elimina tipologia prevendita.

%\begin{center}
%    \includegraphics[scale=0.9]{use_cases.png}
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=1]{Analisi/Cases/use_cases.png}
    \centering
    \caption{use\_cases.vsdx}
\end{figure}

L'utilizzo del login (frecce \textcolor{orange}{arancioni}) è necessario per i casi d'uso.\\Abbiamo differenziato i casi d'uso delle statistiche perché si tratta di concetti diversi.

\newpage

\subsubsection{Scenari}

%Login

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Login \\
	\hline
	\textbf{Descrizione} & Autenticazione nel software gestionale \\
	\hline
	\textbf{Attori} & Utente, Amministratore di Sistema \\
	\hline
	\textbf{Caso d'uso} & Login \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & L'utente deve essere registato nel sistema \\
	\hline
	\textbf{Postcondizioni} & L'utente è autenticato nel sistema \\
	\hline
	\textbf{Scenario principale} & 1. Impostazione di una schermata per l'inserimento di username e password. \\
								 & 2. L'utente inserisce i dati del proprio account. \\
								 & 3. L'utente esegue l'operazione. \\
								 & 4. Il sistema verifica le credenziali. \\
								 & 5. Dopo l'autenticazione viene mostrata una schermata principale.\\
	\hline
	\textbf{Scenari alternativi} & A) L'utente sbaglia credenziali: \\
								 & \quad 1. Notifica all'utente.\\
								 & \quad 2. Ritorno alla schermata di login.\\
								 & B) L'utente ha sbagliato troppe volte le credenziali: \\
								 & \quad 1. Blocco dell'account.\\
								 & \quad 2. Notifica all'utente.\\
								 & \quad 3. Ritorno alla schermata di login.\\
								 & C) L'utente ha la password di default impostata dall'amministratore di sistema:\\
								 & \quad 1. Passaggio al cambio password.\\
								 & D) L'utente ha l'account bloccato:\\
								 & \quad 1. Notifica all'utente.\\
								 & \quad 2. Ritorno alla schermata di login.\\
								 & E) L'utente è gia autenticato:\\
								 & \quad 1. Mostro la schermata principale.\\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R2NF}{R2NF}, \hyperlink{R7NF}{R7NF}, \hyperlink{R16NF}{R16NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}
  
%Gestione Amministrazione

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione Amministrazione \\
	\hline
	\textbf{Descrizione} & Amministrazione del software gestionale \\
	\hline
	\textbf{Attori} & Amministratore di sistema \\
	\hline
	\textbf{Caso d'uso} & Gestione Amministrazione \\
	\hline
	%\textbf{Relazioni} & Login, Registrazione utente \\
	\textbf{Relazioni} & Login \\
	\hline
	\textbf{Precondizioni} & L'utente deve essere registato nel sistema \\
	\hline
	\textbf{Postcondizioni} & L'utente è autenticato nel sistema \\
	\hline
	\textbf{Scenario principale} & 1. Login.\\
	                             & 2. Viene mostrata una schermata con le azioni possibili:\\
								 & \quad a. Registrazione utente\\
								 & 3. L'Amministratore di sistema sceglie l'operazione desiderata.\\
								 & 4. Il sistema cambia vista a seconda della scelta.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Qui metto i casi d'uso sotto gestione amministrazione--------------------------------------

%Registrazione utente

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Registrazione utente \\
	\hline
	\textbf{Descrizione} & Una persona ha richiesto l'accesso al sistema gestionale e l'amministratore vuole registrarlo. \\
	\hline
	\textbf{Attori} & Amministratore di sistema \\
	\hline
	\textbf{Caso d'uso} & Gestione Amministrazione \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & L'amministratore di sistema è autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore si informa riguardo l'utente, chiedendo informazioni per la registrazione.\\
								 & 2. L'utente fornisce i dati all'amministratore.\\
								 & 3. L'amministratore sceglie username e password iniziale per l'utente, utilizzando criteri di sicurezza.\\
	\hline
	\textbf{Scenari alternativi} & A) Dati dell'utente da registrare in conflitto o non validi: \\
								 & \quad 1. Notifica all'amministratore.\\
								 & \quad 2. L'amministratore cerca di correggere i dati.\\
								 & \quad 3. L'amministratore ripete l'operazione.\\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R2NF}{R2NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}




%Aggiungi log
%Non so se mettere la relazione con login.

% \begin{center}
% \begin{tabularx}{1\textwidth}{l|X}
% \textbf{Titolo} & Aggiungi log \\
% \hline
% \textbf{Descrizione} & Aggiunta di una voce di log nel sistema gestionale \\
% \hline
% \textbf{Attori} & Amministratore di sistema \\
% \hline
% \textbf{Relazioni} & Gestione log \\
% \hline
% \textbf{Precondizioni} &  \\
% \hline
% \textbf{Postcondizioni} &  \\
% \hline
% \textbf{Scenario principale} & 1. Il sistema mostra una vista per l'inserimento della voce del log.\\
% & 2. L'amministratore di sistema aggiunge le informazioni.\\
% & 3. L'amministratore esegue l'operazione.\\
% & 4. Ritorno alla schermata precedente.\\
% \hline
% \textbf{Scenari alternativi} & A) L'utente non è autenticato: \\
% & \quad 1. Notifica all'utente.\\
% & \quad 2. Passaggio al login.\\
% & B) L'utente non è amministratore di sistema:\\
% & \quad 1. Notifica all'utente.\\
% & \quad 2. Passaggio alla schermata precedente.\\
% & C) La richiesta di aggiunta log viene

% \hline
% \textbf{Requisiti non funzionali} &  \hyperlink{R22NF}{R22NF} \\
% \hline
% \textbf{Punti aperti} & \\
% \hline
% \end{tabularx}
% \end{center}

%------------------------------------------------------

%Gestione utente

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione utente \\
	\hline
	\textbf{Descrizione} & Gestione degli utenti presenti nel software gestionale \\
	\hline
	\textbf{Attori} & Utente \\
	\hline
	\textbf{Caso d'uso} & Gestione utente \\
	\hline
	%\textbf{Relazioni} & Login, Cambia password, Accedi staff, Crea staff, Gestione log, Registrazione utente, Sblocco utente \\
	%\textbf{Relazioni} & Login, Cambia password, Accedi staff, Crea staff \\
	\textbf{Relazioni} & Login \\
	\hline
	\textbf{Precondizioni} & L'utente deve essere registato nel sistema \\
	\hline
	\textbf{Postcondizioni} & L'utente è autenticato nel sistema \\
	\hline
	\textbf{Scenario principale} & 1. Login.\\
	                             & 2. Viene mostrata una schermata con le azioni possibili:\\
								 & \quad a. Cambia Password.\\
								 & \quad b. Accedi staff.\\
								 & \quad c. Crea staff.\\
								 & \quad d. Scegli Staff\\
								 & 3. L'utente sceglie l'operazione desiderata.\\
								 & 4. Il sistema cambia vista a seconda della scelta.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Qui metto i casi d'uso sotto gestione utente------------------------------------------

% Crea staff

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
		\textbf{Titolo} & Crea staff \\
		\hline
		\textbf{Descrizione} & Creazione di uno staff \\
		\hline
		\textbf{Attori} & Utente \\
		\hline
		\textbf{Caso d'uso} & Gestione utente \\
	    \hline
		\textbf{Relazioni} &  \\
		\hline
		\textbf{Precondizioni} & Utente già autenticato \\
		\hline
		\textbf{Postcondizioni} &  \\
		\hline
		\textbf{Scenario principale} & 1. L'utente accede alla creazione staff. \\
									 & 2. Il sistema fornisce una vista di creazione. \\
									 & 3. L'utente inserisce i dati del nuovo staff. \\
									 & 4. L'utente esegue l'operazione.\\
									 & 5. Ritorno alla schermata precedente.\\
		\hline
		\textbf{Scenari alternativi} & A) L'utente ha già creato uno staff: \\
									 & \quad 1. Notifica all'utente \\
									 & \quad 2. Ritorno alla schermata precedente.\\
		\hline
		\textbf{Requisiti non funzionali} & \hyperlink{R3NF}{R3NF} \\
		\hline
		\textbf{Punti aperti} & \\
		\hline
	\end{tabularx}
\end{center}

%Cambia password

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Cambia password \\
	\hline
	\textbf{Descrizione} & Cambio della password di un utente \\
	\hline
	\textbf{Attori} & Utente \\
	\hline
	\textbf{Caso d'uso} & Gestione utente \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & Utente già autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'utente accede al cambio password. \\
								 & 2. Il sistema fornisce una vista. \\
								 & 3. L'utente inserisce i dati per il cambio di password. \\
								 & 4. L'utente esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R2NF}{R2NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Accedi staff

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Accedi allo staff \\
	\hline
	\textbf{Descrizione} & Permettere di diventare membro di uno staff \\
	\hline
	\textbf{Attori} & Utente \\
	\hline
	\textbf{Caso d'uso} & Gestione utente \\
	\hline
	\textbf{Relazioni} & \\
	\hline
	\textbf{Precondizioni} & Utente già autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'utente accede alla schermata di accedi staff. \\
								 & 2. Il sistema fornisce una vista. \\
								 & 3. L'utente inserisce i dati per l'accesso allo staff. \\
								 & 4. L'utente esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & A) L'utente è già membro dello staff:\\
								 & \quad 1. Notifica all'utente.\\
								 & \quad 2. Ritorno alla schermata precedente.\\
								 & B) L'utente ha fornito un codice di accesso errato:\\
								 & \quad 1. Notifica all'utente.\\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R3NF}{R3NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%----------------------------------------------------------------------------------------

%rimosso Gestione staff
  
%Qui metto i casi d'uso sotto gestione staff--------------------------------------------------

%Visualizza statistiche personali

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Visualizza statistiche personali \\
	\hline
	\textbf{Descrizione} & Permettere di visualizzare le statistiche personali di un membro come PR o cassiere. \\
						 & Non è associato direttamente a PR e a cassiere perché i ruoli di un membro potrebbero cambiare.\\
	\hline
	\textbf{Attori} & Membro \\
	\hline
	\textbf{Caso d'uso} & Visualizza statistiche personali \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & Il membro è già autenticato  \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. Il membro accede alla schermata di vusualizzazione delle statistiche personali.\\
								 & 2. Il sistema fornisce una vista con tutte le statistiche. \\
								 & 3. Quando il membro ha finito la consultazione, ritorna alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione vendita prevendita: aggiungi prevendita, annulla prevendita

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione vendita prevendita \\
	\hline
	\textbf{Descrizione} & Permette di gestire la vendita di una prevendita: aggiunta prevendita, annulla prevendita \\
	\hline
	\textbf{Attori} & PR, Cliente \\
	\hline
	\textbf{Caso d'uso} & Gestione vendita prevendita \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & Il PR è già autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. Il PR accede alla schermata di gestione prevenite. \\
								 & 3. Il sistema fornisce una vista con le opzioni possibili. \\
								 & 4. Il PR sceglie l'operazione:\\
								 & \quad a. Aggiungi prevendita.\\
								 & \quad b. Annulla prevendita.\\
								 & \quad c. Lista prevendite.\\
								 & 5. Il PR inserisce i dati relativi all'operazione, consultando il cliente se necessario.\\
								 & 6. Il PR esegue l'operazione.\\
								 & 7bis. Nel caso di aggiungi prevendita si consegna al cliente il documento digitale.\\
								 & 8. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R8NF}{R8NF}, \hyperlink{R9NF}{R9NF}, \hyperlink{R10NF}{R10NF}, \hyperlink{R12NF}{R12NF}, \hyperlink{R14NF}{R14NF}, \hyperlink{R15NF}{R15NF}, \hyperlink{R17NF}{R17NF}, \hyperlink{R19NF}{R19NF}  \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione entrata: timbra entrata, leggi prevendita,

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione entrata \\
	\hline
	\textbf{Descrizione} & Permette di gestire l'entrata di un cliente: timbratura dell'entrata \\
	\hline
	\textbf{Attori} & Cassiere, Cliente \\
	\hline
	\textbf{Caso d'uso} & Gestione entrata \\
	\hline
	\textbf{Relazioni} & \\
	\hline
	\textbf{Precondizioni} & Il Cassiere è già autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. Il Cassiere accede alla schermata di gestione entrata. \\
								 & 2. Il sistema fornisce una vista con le opzioni disponibile.\\
								 & 3. Il Cassiere sceglie l'operazione:\\
								 & \quad a.Timbra entrata.\\
								 & \quad b. Lista entrate.\\
								 & 4. Il Cassiere inserisce i dati dell'operazione, consultando il cliente se necessario.\\
								 & 5. Il cassiere esegue l'operazione.\\
								 & 6. Il Cassiere informa il cliente riguardo l'esito dell'operazione, se necessario.\\
								 & 7. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R18NF}{R18NF}, \hyperlink{R20NF}{R20NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione Amministrazione staff

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
   \hline
	\textbf{Titolo} & Gestione Amministrazione staff \\
	\hline
	\textbf{Descrizione} & Gestione dello staff dell'utente \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestione Amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & Utente autenticato \\
	\hline
	\textbf{Postcondizioni} & \\
	\hline
	\textbf{Scenario principale} & 1. Viene mostrata una schermata con le azioni possibili:\\
								 & \quad a. Gestione membri.\\
								 & \quad b. Cambia codice di accesso.\\
								 & \quad c. Visualizzazione statistiche.\\
								 & \quad d. Gestione eventi.\\
								 & \quad e. Gestione tipologie prevendite.\\
								 & 2. L'amministratore sceglie l'operazione desiderata.\\
								 & 3. Il sistema cambia vista a seconda della scelta.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Cambia codice accesso

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Cambia codice accesso \\
	\hline
	\textbf{Descrizione} & Cambio del codice di accesso allo staff \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestone amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} &  L'amministratore è già autenticato. \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore accede al cambio codice di accesso. \\
								 & 2. Il sistema fornisce una vista. \\
								 & 3. L'amministratore inserisce i dati per il cambio del codice. \\
								 & 4. L'amministratore esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R3NF}{R3NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Visualizza statistiche 

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Visualizza statistiche \\
	\hline
	\textbf{Descrizione} & Permettere di visualizzare le statistiche dello staff. \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestone amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & L'amministratore è già autenticato.  \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore accede alla schermata di vusualizzazione. \\
								 & 2. Il sistema fornisce una vista con tutte le statistiche. \\
								 & 3. Quando l'amministratore ha finito la consultazione, ritorna alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R6NF}{R6NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione eventi: aggiungi evento, modifica evento, annulla evento

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione eventi \\
	\hline
	\textbf{Descrizione} & Permettere di gestire gli eventi dello staff. \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestone amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & L'amministratore è già autenticato \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore accede alla schermata di vusualizzazione. \\
								 & 2. Il sistema fornisce una vista con le scelte: \\
								 & \quad a. Aggiungi evento.\\
								 & \quad b. Modifica evento.\\
								 & \quad c. Annulla evento.\\
								 & \quad d. Lista eventi.\\
								 & 3. Una volta scelta l'operazione, l'amministratore inserisce i dati richiesti. \\
								 & 4. L'amministratore esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R8NF}{R8NF}, \hyperlink{R11NF}{R11NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione tipologie prevendite: aggiungi tipologia prevendita, modifica tipologia prevendita, elimina tipologia prevendita.

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione tipologie prevendite \\
	\hline
	\textbf{Descrizione} & Permettere di gestire le tipologie associate alle prevendite di un evento. \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestone amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} & L'amministratore è già autenticato  \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore accede alla schermata di vusualizzazione. \\
								 & 2. Il sistema fornisce una vista con le scelte: \\
								 & \quad a. Aggiungi tipologia evento.\\
								 & \quad b. Modifica tipologia evento.\\
								 & \quad c. Elimina tipologia evento.\\
								 & \quad d. Lista tipologie evento.\\
								 & 3. Una volta scelta l'operazione, l'amministratore inserisce i dati richiesti. \\
								 & 4. L'amministratore esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R9NF}{R9NF}, \hyperlink{R16NF}{R16NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Gestione membri: modifica diritti membro, rimuovi membro

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione membri \\
	\hline
	\textbf{Descrizione} & Permettere di gestire i membri dello staff, concedendo i ruoli o rimuovendo i membri. \\
	\hline
	\textbf{Attori} & Amministratore \\
	\hline
	\textbf{Caso d'uso} & Gestone amministrazione staff \\
	\hline
	\textbf{Relazioni} &  \\
	\hline
	\textbf{Precondizioni} &  L'amministratore è già autenticato. \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore accede alla schermata di vusualizzazione. \\
								 & 2. Il sistema fornisce una vista con le scelte: \\
								 & \quad a. Modifica ruoli membro.\\
								 & \quad b. Rimuovi membro.\\
								 & \quad c. Lista membri.\\
								 & 3. Una volta scelta l'operazione, l'amministratore inserisce i dati richiesti. \\
								 & 4. L'amministratore esegue l'operazione.\\
								 & 5. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & A) L'amministratore si vuole rimuovere ma è l'unico amministratore rimasto nello staff: \\
								 & \quad 1. Notifica all'utente. \\
								 & \quad 2. Ritorno alla schermata precedente. \\
	\hline
	\textbf{Requisiti non funzionali} & \hyperlink{R14F/NF}{R14F/NF} \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%------------------------------------------------------------------------------------------

\newpage

\subsection{Analisi del rischio}

%Alla fine di questa parte vanno introdotti i seguenti vincoli:
%Log delle operazioni
%Blocco utente dopo un tot di tentativi
%Cifratura della comunicazione
%Sistema anti contraffazione: prevendita nominativa + codice
%Sistema locale durante l'evento

\subsubsection{Valutazione dei beni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|l|X|X|}
         \hline
         \textbf{Bene} & \textbf{Valore} & \textbf{Esposizione}  \\
         \hline
         \hline
         \multirow{2}{*}{Sistema gestionale} & Alto & Alta \\
                            & Registra tutte le prevendite di uno staff. Critico dal punto di vista della sicurezza. & Perdita d'immagine del software e degli staff, spesa in tempo per il ripristino del backup, se il sistema fallisce è necessario acquistare prevendite fisiche. Possibili perdite finanziare. \\
         \hline
         \multirow{2}{*}{Informazioni su utenti} & Medio-Alto & Alta\\
                            & Informazioni relative agli utenti del sistema, anche le credenziali, le quali potrebbero permettere l'accesso ai dati dello staff e relativi clienti. & Perdita d'immagine del software, un membro con ruolo amministrativo potrebbe compromettere temporaneamente uno staff fino a ripristino backup. Possibile perdita economica dovuta all'aggiunta di prevendite.\\
         \hline
         \multirow{2}{*}{Informazioni su prevendite} & Alto & Alta \\
                                    & Rappresentano i guadagni per uno staff, nonché il biglietto d'ingresso di un cliente. & Perdita d'immagine del software: lo staff ha perso informazioni riguardo i ricavi. Perdita d'immagine dello staff: il cliente non riesce a entrare. Possibile perdita economica se vengono aggiunte prevendite non dovute.\\
         \hline
         \multirow{2}{*}{Informazioni su clienti} & Medio & Bassa \\
                                  & Le informazioni sono ridotte al solo nome e cognome (\hyperlink{R23F}{R23F}). & \\
         \hline
         \multirow{2}{*}{\shortstack[l]{Informazioni su\\ amministratori di sistema}} & Alto &  Alta \\
                                                    & Ha poteri sul sistema gestionale. &  Possibilità di perdere informazioni di sistema. Perdita d'immagine del software.\\ 
         \hline
    \end{tabularx}
\end{center}

\subsubsection{Analisi minacce e controlli}


\begin{center}
    \begin{tabulary}{1\textwidth}{|L|C|C|C|}
        \hline
        \textbf{Minaccia} & \textbf{Probabilità} & \textbf{Controllo} & \textbf{Fattibilità}  \\
        \hline
        \hline
        Furto d’identità (utente) & Media-Bassa. Username e password scelti dall'amministratore di sistema. & Log degli accessi, blocco dell'utente. & Costo minimo\\
        \hline
        Furto d’identità (amministratore di sistema) & Bassa & Log degli accessi & Costo minimo\\
        \hline
        Alterazione dei dati nella comunicazione & Medio-Alta. Molte comunicazione avvengono nel sistema distribuito client/server. & Uso di canale sicuro & Costo basso anche se si utilizza un mix tra chiave simmetrica e asimmetrica.\\
        Man in the Middle &  &  & \\
        \hline
        %DoS/DDoS & Bassa & Sistema locale durante l'evento (\hyperlink{R20NF}{R20NF}) & Costo medio, richiesta di risorse hardware portatili\\
        DoS/DDoS & Bassa & Sistema locale durante l'evento & Costo medio, richiesta di risorse hardware portatili.\\
        \hline
        %Contraffazione della prevendita & Alta & Sistema anti-contraffazione (\hyperlink{R21NF}{R21NF}), prevendita nominativa & Costo minimo\\
        Contraffazione della prevendita & Media & Sistema anti-contraffazione, prevendita nominativa & Costo minimo\\
        \hline
        Furto della prevendita & Media & Prevendita nominativa & Costo minimo\\
        \hline
    \end{tabulary}
\end{center}

\newpage

\subsubsection{Analisi della tecnologia dal punto di vista della sicurezza}

\begin{center}
    \begin{tabularx}{1\textwidth}{|l|X|}
        \hline
        \textbf{Tecnologia} & \textbf{Vulnerabilità} \\
        \hline
        \hline
       \multirow{9}{*}{Cifratura delle comunicazioni} & Utilizzo di una \textbf{doppia cifratura} simmetrica e asimmetrica con le loro relative vulnerabilità:\\
                                      & \quad \textbf{Cifratura Simmetrica}:\\
                                      & \quad\quad 1. Tempo di vita della chiave\\
                                      & \quad\quad 2. Memorizzazione della chiave\\
                                      & \quad\quad 3. Lunghezza della chiave\\
                                      & \quad \textbf{Cifratura Asimmetrica}:\\
                                      & \quad\quad 1. Lunghezza della chiave\\
                                      & \quad\quad 2. Memorizzazione della chiave privata\\
                                      & L'utilizzo di cifrature standard non recenti potrebbero causare vulnerabilià ulteriori.\\
        \hline
        \multirow{3}{*}{Autenticazione tramite credenziali} & \textbf{Social engineering}: un utente potrebbe essere vittima di un attacco di social engineering, volto al furto delle credenziali. \\
                                           & \textbf{Password cracking}: attraverso metodologie di cracking delle password, l'attaccante risale alla password di un utente o amministratore di sistema. \\
                                           & \textbf{Negligenza}: L'utente volontariamente o per sbaglio fornisce le credenziali a terzi. \\
        \hline
        \multirow{5}{*}{Architettura Client/Server} & \textbf{Attacco DDoS/DoS}: l'obiettivo dell'attacco è quello di negare il servizio offerto agli utenti. \\
                                   & \textbf{Attacco Man in the Middle}: un malintenzionato potrebbe riuscire a sottrarre informazioni o effettuare operazioni illecite. \\
                                   & \textbf{Sniffing della comunicazione}: un malintezionato potrebbe riusire ad intercettare una comunicazione e a sottrarne informazioni. \\
                                   & \textbf{Deadlock}: Il servitore potrebbe trovarsi in una situzione di stallo generata da una richiesta ciclica. \\
                                   & \textbf{Esposizione dei client}: I client sono esposti, dato che devono connettersi al servitore.\\
        \hline
        %Non so se questa va bene.
        %Servizio di hosting esterno & Esposizione dei dati \\
        %\hline
    \end{tabularx}
\end{center}

\subsubsection{Security Use Case e Misuse Case}

%\begin{center}
%    \includegraphics[scale=0.73]{security_use_cases_misuse_cases.png}
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=0.9]{Analisi/Cases/security_use_cases_misuse_cases.png}
    \centering
    \caption{security\_use\_cases\_misuse\_cases.vsdx}
\end{figure}

\newpage

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Garantire Protezione}\\
    \hline
    \textbf{Percorso d’uso} & \mc{2}{Garantire Protezione dei dati persistenti}\\
    \hline
    \textbf{Misuse case} & \mc{2}{Man in the Middle, Sniffing, Furto credenziali}\\
    \hline
    \textbf{Descrizione} & \mc{2}{I dati persistenti devono essere protetti.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un utente malintenzionato potrebbe modificare o compromettere i dati relativi al software gestionale, come gli utenti registrati o le prevendite di un evento.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{ 1. Il sistema è già stato utilizzato dall'amministratore di sistema per la registrazione degli utenti e/o uno staff ha già registrato delle prevendite per un evento.}\\
    & \mc{2}{2. L'attaccante ha i mezzi necessari per tentare di modificare i dati persistenti.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema blocca il tentativo di modifica o compromissione dei dati persistenti.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante cerca di modificare dati persistenti del sistema gestionale. \\
    \cline{2-3}
    & Il sistema blocca l'attacco e notifica l'amministratore di sistema.  &  \\
    \hline
    \textbf{Scenario di attacco avvenuto con successo} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante riesce ad accedere/modificare dati persistenti.\\
    \cline{2-3}
    & Il sistema registra nei log le modifiche effettuate. & \\
    \cline{2-3}
    & L'amministratore di sistema nota i log anomali e opera di conseguenza. & \\
    \hline
\end{tabularx}
\end{center}

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Garantire Protezione}\\
    \hline
    \textbf{Percorso d’uso} & \mc{2}{Garantire Protezione dei dati della comunicazione}\\
    \hline
    \textbf{Misuse case} & \mc{2}{Man in the Middle, Sniffing, Furto credenziali}\\
    \hline
    \textbf{Descrizione} & \mc{2}{I dati che viaggiano nelle comunicazioni devono essere protetti.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un utente malintenzionato potrebbe leggere o alterare i dati in transito in una comunicazione.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{1. Il malintezionato ha la possibilità di intercettare i dati.}\\
    & \mc{2}{2. Il malintenzionato ha la possibilità di modificare i dati.}\\
    & \mc{2}{3. ha i mezzi per spedire il messaggio modificato al destinatario.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema rileva il tentativo di modifica della comunicazione.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & Il sistema si occupa di garantire una comunicazione dei messaggi sicura. & \\
    \cline{2-3}
    & & L'attaccante rileva un messaggio in transito, lo interecetta, lo modifica e lo inoltra all'utente finale. \\
    \cline{2-3}
    & Il sistema riceve il messaggio modificato e rileva il tentativo di lettura o modifca, rifiutandolo e segnalandolo nei log.  &  \\
    \hline
    \textbf{Scenario di attacco avvenuto con successo} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & Il sistema si occupa di garantire una comunicazione dei messaggi sicura. & \\
    \cline{2-3}
    & & L'attaccante riesce ad alterare la comunicazione senza che il sistema se ne accorga.\\
    \cline{2-3}
    & Il sistema registra nei log le modifiche effettuate. & \\
    \cline{2-3}
    & L'amministratore di sistema nota i log anomali e opera di conseguenza. & \\
    \hline
\end{tabularx}
\end{center}

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Garantire Protezione}\\
    \hline
    \textbf{Percorso d’uso} & \mc{2}{Garantire Protezione rispetto alle contraffazioni}\\
    \hline
    \textbf{Misuse case} & \mc{2}{Contraffazione}\\
    \hline
    \textbf{Descrizione} & \mc{2}{Devo garantire che le prevendite lette siano autentiche.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un utente malintenzionato potrebbe falsificare una prevendita, mediante documento digitale consegnato.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{1. Il malintezionato conosce la struttura di una prevendita e del documento digitale.}\\
    & \mc{2}{2. Il malintenzionato ha la possibilità di falsificare la prevendita.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema rileva che la prevendita non è autentica.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & Il sistema si occupa di garantire l'autenticità delle prevendite consegnate. & \\
    \cline{2-3}
    & & L'attaccante crea una prevendita falsificata e tenta il riconoscimento da parte del sistema. \\
    \cline{2-3}
    & Il sistema rileva che la prevendita è contraffatta, rifiutandola e segnalandola nei log.  &  \\
    \hline
    \textbf{Scenario di attacco avvenuto con successo} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & Il sistema si occupa di garantire l'autenticità delle prevendite consegnate. & \\
    \cline{2-3}
    & & L'attaccante riesce a creare una prevendita che illuda il sistema.\\
    \cline{2-3}
    & Il sistema registra nei log l'entrata effettuata. & \\
    \cline{2-3}
    & L'amministratore dello staff nota una discrepanza e informa l'amministratore di sistema. & \\
    \cline{2-3}
    & L'amministratore di sistema fa una ricerca nei log e tenta di risalire al malfattore. & \\
    \hline
\end{tabularx}
\end{center}

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Controllo Accesso}\\
    \hline
    \textbf{Percorso d’uso} & \mc{2}{Controllo sull'autenticazione dell'utente}\\
    \hline
    \textbf{Misuse case} & \mc{2}{Furto credenziali}\\
    \hline
    \textbf{Descrizione} & \mc{2}{Il sistema deve proteggere l'utente da intrusioni di malintenzionati.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un malintenzionato ruba i dati di identificazione e autenticazione ad un utente.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{1. Il malintezionato ha la possibilità di trovare l'username.}\\
    & \mc{2}{2. Il malintenzionato ha la possibilità di tentare l'accesso al sistema.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema rileva il tentativo di accesso fraudolento e blocca l'utente.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante tenta un attacco di password cracking. \\
    \cline{2-3}
    & Il sistema rileva l'attacco e blocca l'account dell'utente. &  \\
    \hline
    \textbf{Scenario di attacco avvenuto con successo} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante riesce a scoprire la password. \\
    \cline{2-3}
    & Il sistema fornisce l'accesso al sistema. & \\
    \cline{2-3}
    & & Il malintenzionato tenta di reperire tutte le informazioni prima di essere scoperto. \\
    \cline{2-3}
    & Il sistema notifica nei log le operazioni effettuate. & \\
    \cline{2-3}
    & L'amministratore di sistema nota i log anomali e opera di conseguenza. & \\
    \hline
\end{tabularx}
\end{center}

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Controllo Accesso}\\
    \hline
    \textbf{Percorso d’uso} & \mc{2}{Controllo sulle operazioni eseguite dagli utenti}\\
    \hline
    \textbf{Misuse case} & \mc{2}{Operazione non autorizzata}\\
    \hline
    \textbf{Descrizione} & \mc{2}{Il sistema deve evitare che utenti non autorizzati possano eseguire operazioni non concesse. Deve essere valido sia per i ruoli di uno staff, sia per il ruolo di amministratore di sistema.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un utente normale esegue senza autorizzazione operazioni riservate all'amministratore di sistema.}\\
    & \mc{2}{Un membro di uno staff esegue senza autorizzazione operazioni riservate ad un ruolo che non ha.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{1. L'utente ha credenziali validi per l'accesso.}\\
    & \mc{2}{2. L'utente non ha i privilegi per cui sta tentando di effettuare l'operazione.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema rileva il tentativo di esecuzione non autorizzata e blocca l'operazione.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'utente tenta di eseguire un operazione non consentita. \\
    \cline{2-3}
    & Il sistema verifica le autorizzazioni dell'utente e blocca l'operazione non autorizzata. &  \\
    & Il sistema aggiunge un record di log su quanto accaduto. &  \\
    \hline
\end{tabularx}
\end{center}

\begin{center}
\begin{tabularx}{1\textwidth}{|X|X|X|}
    \hline
    \textbf{Caso d’uso} & \mc{2}{Disponibilità}\\
    \hline
    \textbf{Misuse case} & \mc{2}{DDoS/DoS}\\
    \hline
    \textbf{Descrizione} & \mc{2}{Il sistema deve cercare di proteggersi da attacchi DDoS/DoS.}\\
    \hline
    \textbf{Rischi alla sicurezza} & \mc{2}{Un malintenzionato vuole impedire l'accesso al sistema durante un evento.}\\
    \hline
    \textbf{Precondizioni} & \mc{2}{1. Il malintezionato dispone dei mezzi per effettuare l'attacco.}\\
    \hline
    \textbf{Postcondizioni} & \mc{2}{ Il sistema si protegge dalla minaccia.}\\
    \hline
    \textbf{Scenario principale} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante tenta un attacco DDoS/DoS. \\
    \cline{2-3}
    & Il sistema rileva l'attacco e informa l'amministratore di sistema, mentre cerca di attuare misure per ridurre l'efficacia dell'attacco. &  \\
    \cline{2-3}
    & Il sistema riesce a contenere l'attacco, dato che l'attaccante non ha sufficiente potenza per mettere fuori uso il sistema. &  \\
    \cline{2-3}
    & L'amministratore di sistema controlla lo stato e agisce di conseguenza. &  \\
    \hline
    \textbf{Scenario di attacco avvenuto con successo} & \textbf{Sistema} & \textbf{Attaccante}\\
    \hline
    & & L'attaccante tenta un attacco DDoS/DoS. \\
    \cline{2-3}
    & Il sistema rileva l’attacco e informa l’amministratore di sistema, mentre cerca di attuare misure per ridurre l’efficacia dell’attacco. & \\
    \cline{2-3}
    & Il sistema non riesce a contenere l'attacco e va fuori uso. & \\
    \cline{2-3}
    & L'amministratore di sistema vede che il sistema di fuori uso e tenta un ripristino locale per favorire l'accesso al sistema durante l'evento. & \\
    \hline
\end{tabularx}
\end{center}

\subsubsection{Requisiti di Protezione dei Dati}

Dall’analisi del rischio sono emersi altri requisiti riguardanti la protezione dei dati:

\begin{itemize}
    \item Creazione di un sistema di log per il tracciamento delle operazioni svolte nel sistema gestionale, garantendo la persistenza dei log. L'amministratore di sistema è l'unico a poter accedere ai log. Per evitare l'uscita di informazioni riservate, cercare di memorizzare nei log solo le informazioni utili per l'analisi da parte dell'amministratore.
    \item Creare un sistema per il blocco dell'utente dopo un certo numero di tentativi. L'amministratore di sistema ha la possibilità di sbloccare l'utente.
    \item I dati scambiati devono essere protetti con cifratura sicura per evitare alterazione e lettura di dati privati.
    \item I dati persistenti del sistema devono essere protetti da eventuali intrusioni.
    \item Necessità di un sistema per il controllo delle autorizzazioni degli utenti.
    \item Il sistema deve essere in grado di ridurre l'impatto di attacchi DoS, per esempio tramite blacklisting di IP o tramite servizi esterni, come l'uso di reverse proxy, ovviamente configurato a dovere, non come il sistema dell'INPS.
    \item Inoltre il sistema deve essere strutturato in maniera da consentire il ripristino locale ad un evento da parte dell'amministratore di sistema, nel caso che l'attacco DoS funzioni.
    \item Il sistema deve prevedere un sistema di anti-contraffazione per garantire l'autenticità delle preventite.
\end{itemize}

\subsubsection{Requisiti di sistema aggiornati}

\paragraph{REQUISITI FUNZIONALI}

\begin{itemize}
    \item \hypertarget{R24F}{R24F} - Creare un sistema di log per il tracciamento delle operazioni automatico.
    \item \hypertarget{R25F}{R25F} - L'amministratore di sistema deve avere il pieno controllo dei log.
    \item \hypertarget{R26F}{R26F} - Creare un sistema per il bloccaggio dell'account dopo vari tentativi. L'amministratore di sistema ha l'autorizzazione a sbloccare l'account.
\end{itemize}

\paragraph{REQUISITI NON FUNZIONALI}

\begin{itemize}
    %HTTPS
    \item \hypertarget{R22NF}{R22NF} - I dati della comunicazione devono essere protetti.
    \item \hypertarget{R23NF}{R23NF} - I dati persistenti devono essere protetti.
    \item \hypertarget{R24NF}{R24NF} - Il sistema deve verificare le autorizzazioni degli utenti e dei membri.
    \item \hypertarget{R25NF}{R25NF} - Il sistema deve cercare di garantire la disponibilità del servizio.
    %Sistema locale senza server remoto tramite server locale + wifi
    \item \hypertarget{R26NF}{R26NF} - Il sistema deve essere strutturato in modo da essere replicabile localmente.
    \item \hypertarget{R27NF}{R27NF} - Il sistema deve essere in grado di riconoscere prevendite contraffatte.
    %Devo contare i tentativi falliti nel db: nella sessione potrei cancellare i cookie.
    \item \hypertarget{R28NF}{R28NF} - Il blocco dell'account deve avvenire dopo 3 tentativi.
\end{itemize}


\subsubsection{Glossario aggiornato}

  \begin{center}
    \begin{tabulary}{1\textwidth}{|c|C|C|}
        \hline
        \textbf{Voce} & \textbf{Definizione} & \textbf{Sinonimi}\\
        \hline
        \hline
		Log & Registro dove vengono salvate informazioni per risalire ad operazioni critiche svolte. Composto da una serie di voci. & Registro \\
		\hline
		Voce di log & Si tratta di una riga del log. & Record del log\\
		\hline
		Blocco dell'utente & Operazione automatica eseguita per la protezione del sistema. L'utente non può più effettuare l'operazione di autenticazione con successo. & Blocco dell'account utente \\
		\hline
		Sblocco dell'utente & Operazione eseguita da un amministratore di sistema, per il ripristino di un utente con autenticazione bloccata. & Sblocco dell'account utente\\
		\hline
		Verifica Contraffazione & Sistema volto a verificare l'autenticità di un documento digitale. & \\
		\hline
    \end{tabulary}
  \end{center}

\newpage

\subsubsection{Casi d'uso aggiornati}

%\begin{center}
%    \includegraphics[scale=0.9]{use_cases_aggiornato.png}
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=1]{Analisi/Cases/use_cases_aggiornato.png}
    \centering
    \caption{use\_cases\_aggiornato.vsdx}
\end{figure}

Vengono aggiunti due casi d'uso: Gestione log e Sblocco utente. Entrambi casi d'uso sono associati ad un amministratore di sistema.

\newpage

\subsubsection{Scenari aggiornati}

% Gestione log
%Forse da dividere in aggiungi log, leggi log e cancella log.

\begin{center}
\begin{tabularx}{1\textwidth}{|l|X|}
    \hline
	\textbf{Titolo} & Gestione log \\
	\hline
	\textbf{Descrizione} & Gestione del log del software gestionale \\
	\hline
	\textbf{Attori} & Amministratore di sistema \\
	\hline
	\textbf{Relazioni} & Gestione Amministrazione \\
	\hline
	\textbf{Precondizioni} &  \\
	\hline
	\textbf{Postcondizioni} &  \\
	\hline
	\textbf{Scenario principale} & 1. L'amministratore di sistema è già autenticato.\\
	                             & 2. L'amministratore di sistema sceglie una funzione: \\
								 & \quad a. Aggiungi log \\
								 & \quad b. Leggi log \\
								 & 3. L'amministratore di sistema esegue l'operazione.\\
								 & 4. Ritorno alla schermata precedente.\\
	\hline
	\textbf{Scenari alternativi} & \\
	\hline
	\textbf{Requisiti non funzionali} & \\
	\hline
	\textbf{Punti aperti} & \\
	\hline
\end{tabularx}
\end{center}

%Sblocco utente

\begin{center}
    \begin{tabularx}{1\textwidth}{|l|X|}
        \hline
        \textbf{Titolo} & Sblocco utente \\
        \hline
        \textbf{Descrizione} & Caso in cui un utente è bloccato e chiede aiuto all'amministratore di sistema. \\
        \hline
        \textbf{Attori} & Amministratore di sistema \\
        \hline
        \textbf{Relazioni} & Gestione Amministrazione \\
        \hline
        \textbf{Precondizioni} &  \\
        \hline
        \textbf{Postcondizioni} &  \\
        \hline
        \textbf{Scenario principale} & 1. L'amministratore di sistema è già autenticato.\\
                                     & 2. L'amministratore si informa riguardo l'utente.\\
                                     & 3. L'utente si spiega di quanto accaduto con l'amministratore.\\
                                     & 4. Se decide di sbloccarlo allora inserisce i dati nell'apposita vista.\\
                                     & 5. L'amministratore esegue l'operazione e l'utente viene sbloccato.\\
        \hline
        \textbf{Scenari alternativi} & \\
        \hline
        \textbf{Requisiti non funzionali} & \\
        \hline
        \textbf{Punti aperti} & \\
        \hline
    \end{tabularx}
\end{center}

%Nello scenario login ho aggiunto il requisito non funzionale

\begin{center}
    \begin{tabularx}{1\textwidth}{|l|X|}
        \hline
    	\textbf{Titolo} & Login \\
    	\hline
    	\textbf{Descrizione} & Autenticazione nel software gestionale. \\
    	\hline
    	\textbf{Attori} & Utente, Amministratore di Sistema \\
    	\hline
    	\textbf{Relazioni} &  \\
    	\hline
    	\textbf{Precondizioni} & L'utente deve essere registrato nel sistema. \\
    	\hline
    	\textbf{Postcondizioni} & L'utente è autenticato nel sistema. \\
    	\hline
    	\textbf{Scenario principale} & 1. Impostazione di una schermata per l'inserimento di username e password. \\
    								 & 2. L'utente inserisce i dati del proprio account. \\
    								 & 3. L'utente esegue l'operazione. \\
    								 & 4. Il sistema verifica le credenziali. \\
    								 & 5. Dopo l'autenticazione viene mostrata una schermata principale.\\
    	\hline
    	\textbf{Scenari alternativi} & A) L'utente sbaglia credenziali: \\
    								 & \quad 1. Notifica all'utente.\\
    								 & \quad 2. Ritorno alla schermata di login.\\
    								 & B) L'utente ha sbagliato troppe volte le credenziali: \\
    								 & \quad 1. Blocco dell'account.\\
    								 & \quad 2. Notifica all'utente.\\
    								 & \quad 3. Ritorno alla schermata di login.\\
    								 & C) L'utente ha la password di default impostata dall'amministratore di sistema:\\
    								 & \quad 1. Passaggio al cambio password.\\
    								 & D) L'utente ha l'account bloccato:\\
    								 & \quad 1. Notifica all'utente.\\
    								 & \quad 2. Ritorno alla schermata di login.\\
    								 & E) L'utente è gia autenticato:\\
    								 & \quad 1. Mostro la schermata principale.\\
    	\hline
    	\textbf{Requisiti non funzionali} & \hyperlink{R2NF}{R2NF}, \hyperlink{R7NF}{R7NF}, \hyperlink{R16NF}{R16NF}, \hyperlink{R28NF}{R28NF} \\
    	\hline
    	\textbf{Punti aperti} & \\
    	\hline
    \end{tabularx}
    \textit{Viene aggiunto semplicemente il requisito} \hyperlink{R28NF}{R28NF}
\end{center}



\newpage

%\subsection{Descrizione delle interfacce grafiche}
%\newpage

\section{Analisi del problema}

\subsection{Analisi delle funzionalità}

\subsubsection{Tabella delle funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
        \hline
        \textbf{Funzionalità} & \textbf{Tipo} & \textbf{Grado di Complessità} & \textbf{Requisiti collegati}\\
        \hline
        \hline
        Autenticazione & Lettura di dati, interazione con l'esterno & Semplice & \hyperlink{R1F}{R1F}, \hyperlink{R2F}{R2F} \\
        \hline
        Gestione Amministrazione & Gestione dei dati, memorizzazione dei dati, interazione con l'esterno & Complesso & \\
        \hline
        Gestione log & Gestione dei dati, interazione con l'esterno & Semplice & \hyperlink{R24F}{R24F}, \hyperlink{R25F}{R25F}\\
        \hline
        Scrittura log & Memorizzazione di dati & Semplice & \hyperlink{R24F}{R24F}\\
        \hline
        Sblocco utente & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Semplice & \hyperlink{R26F}{R26F}\\
        \hline
        Registrazione utente & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R1F}{R1F}, \hyperlink{R2F}{R2F}, \hyperlink{R4F}{R4F} \\
        \hline
        Gestione utente & Gestione dei dati, memorizzazione dei dati, interazione con l'esterno & Complesso & \\
        \hline
        Crea staff & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R23Fbis}{R23Fbis}, \hyperlink{R3F}{R3F}, \hyperlink{R21NFbis}{R21NFbis}\\
        \hline
        Accedi staff & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Semplice & \hyperlink{R23Fbis}{R23Fbis}, \hyperlink{R3F}{R3F}, \hyperlink{R10F}{R10F} \\
        \hline
        Cambia password & Gestione dei dati, interazione con l'esterno & Semplice & \hyperlink{R2F}{R2F}, \hyperlink{R5F}{R5F} \\
        \hline
        %Gestione staff & Gestione dei dati, interazione con l'esterno & Complesso & \hyperlink{R6F}{R6F}, \hyperlink{R9F}{R9F},  \\
        Gestione amministrazione staff & Gestione dei dati, memorizzazione dei dati, interazione con l'esterno & Complesso &  \\
        \hline
        Visualizzazione statistiche personali & Lettura dati, interazione con l'esterno & Semplice &  \hyperlink{R22F}{R22F} \\
        \hline
        Gestione vendita prevendita & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R8F}{R8F}, \hyperlink{R12F}{R12F}, \hyperlink{R13F}{R13F}, \hyperlink{R21F}{R21F}, \hyperlink{R23F}{R23F} \\
        \hline
        Gestione entrata & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R7F}{R7F}, \hyperlink{R11F}{R11F}, \hyperlink{R12F}{R12F} \\
        \hline
        Gestione membri & Gestione dei dati, interazione con l'esterno & Complesso & \hyperlink{R6F}{R6F}, \hyperlink{R9F}{R9F}, \hyperlink{R14F/NF}{R14F/NF} \\
        \hline
        Cambia codice accesso & Gestione dei dati, interazione con l'esterno & Semplice & \hyperlink{R15F}{R15F}  \\
        \hline
        Visualizzazione statistiche & Lettura dati, interazione con l'esterno & Semplice & \hyperlink{R9F}{R9F}  \\
        \hline
        Gestione eventi & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R9F}{R9F}, \hyperlink{R16F}{R16F}, \hyperlink{R18F}{R18F}, \hyperlink{R19F}{R19F} \\
        \hline
        Gestione tipologie prevendite & Gestione dei dati, memorizzazione di dati, interazione con l'esterno & Complesso & \hyperlink{R9F}{R9F}, \hyperlink{R17F}{R17F}, \hyperlink{R20F}{R20F} \\
        \hline
    \end{tabularx}
\end{center}

\newpage

\subsubsection{Tabelle Informazioni/Flusso}

\textbf{Gestione Amministrazione - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione log  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Record d'inserimento & Complesso & Medio & Input & \\
        \textbf{Composto da:} & & & & \\
        Timestamp & Semplice & Medio & Input & \\
        Descrizione & Semplice & Medio & Input & Non più di 256 caratteri \\
        Livello di importanza & Semplice & Medio & Input & \textbf{Enumeratore}: Basso, Medio, Alto\\
        \hline
        Record di lettura & Complesso & Medio & Output & \\
        \textbf{Composto da:} & & & & \\
        Timestamp & Semplice & Medio & Output & \\
        Descrizione & Semplice & Medio & Output & Non più di 256 caratteri \\
        Livello di importanza & Semplice & Medio & Output & \textbf{Enumeratore}: Basso, Medio, Alto\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Scrittura log  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Record d'inserimento & Complesso & Medio & Input & \\
        \textbf{Composto da:} & & & & \\
        Timestamp & Semplice & Medio & Input & \\
        Descrizione & Semplice & Medio & Input & Non più di 256 caratteri \\
        Livello di importanza & Semplice & Medio & Input & \textbf{Enumeratore}: Basso, Medio, Alto\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Sblocco utente  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Informazioni per lo sblocco & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Registrazione utente  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Nome & Semplice & Medio & Input & Non più di 100 caratteri\\
        \hline
        Cognome & Semplice & Medio & Input & Non più di 100 caratteri\\
        \hline
        Telefono & Semplice & Alto & Input & Non più di 20 caratteri\\
        \hline
        Username & Semplice & Alto & Input & Non più di 20 caratteri\\
        \hline
        Password & Semplice & Alto & Input & \hyperlink{R2NF}{R2NF}, non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\newpage

\textbf{Gestione Utente - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Staff scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Crea staff  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Nome & Semplice & Basso & Input & Non più di 100 caratteri\\
        \hline
        Codice di accesso & Semplice & Alto & Input & \hyperlink{R3NF}{R3NF}, Non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Accedi staff  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Nome & Semplice & Basso & Input & Non più di 50 caratteri\\
        \hline
        Codice di accesso & Semplice & Alto & Input & \hyperlink{R3NF}{R3NF}, Non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Cambia password  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Vecchia password & Semplice & Alto & Input & \hyperlink{R2NF}{R2NF}, Non più di 50 caratteri\\
        \hline
        Nuova password & Semplice & Alto & Input & \hyperlink{R2NF}{R2NF}, Non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione amministrazione staff  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        %Ruolo & Semplce & Alto & Input & \hyperlink{R6F}{R6F} \\
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Visualizzazione statistiche personali  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Entrate svolte & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Nome evento & Semplice & Basso & Output & \\
        Numero entrate & Semplice & Basso & Output & \\
        \hline
        Guadagni & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Nome evento & Semplice & Basso & Output & \\
        guadagni totali & Semplice & Basso & Output & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione vendita prevendita  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Prevendita & Complesso & Medio & Input & \hyperlink{R23F}{R23F}, \hyperlink{R9NF}{R9NF}, \hyperlink{R10NF}{R10NF}, \hyperlink{R14NF}{R14NF}, \hyperlink{R15NF}{R15NF}, \hyperlink{R17NF}{R17NF}, \hyperlink{R19NF}{R19NF}, \hyperlink{R27NF}{R27NF} \\
        \textbf{Composto da:} & & & & \\
        Nome cliente & Semplice & Medio & Input & \\
        Cognome cliente & Semplice & Medio & Input & \\
        Evento associato & Semplice & Medio & Input & \\
        Tipologia prevendita associata & Semplice & Medio & Input & \\
        PR Associato & Semplice & Medio & Input & \\
        \hline
        %Documento digitale & Complesso & Medio & Output & \hyperlink{R12NF}{R12NF}, \hyperlink{R27NF}{R27NF}  \\
        %\hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione entrata  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        %Documento digitale & Complesso & Medio & Input & \hyperlink{R12NF}{R12NF}, \hyperlink{R27NF}{R27NF}  \\
        %\hline
        Prevendita & Complesso & Medio & Input & \hyperlink{R23F}{R23F}, \hyperlink{R9NF}{R9NF}, \hyperlink{R10NF}{R10NF}, \hyperlink{R14NF}{R14NF}, \hyperlink{R15NF}{R15NF}, \hyperlink{R17NF}{R17NF}, \hyperlink{R19NF}{R19NF}, \hyperlink{R27NF}{R27NF} \\
        \textbf{Composto da:} & & & & \\
        Nome cliente & Semplice & Medio & Input & \\
        Cognome cliente & Semplice & Medio & Input & \\
        Evento associato & Semplice & Medio & Input & \\
        Tipologia prevendita associata & Medio & Input & \\
        PR Associato & Medio & Input & \\
        \hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione membri  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Informazioni membro & Complesso & Alto & Input & \hyperlink{R6F}{R6F}\\
        \textbf{Composto da:} & & & & \\
        Membro associato & Semplice & Alto & Input & \\
        Ruoli & Semplice & Alto & Input & \\
        \hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}


\textbf{Cambia codice accesso  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Nome dello staff & Semplice & Basso & Input & \\
        \hline
        Vecchio codice di accesso & Semplice & Alto & Input & \hyperlink{R3NF}{R3NF}, Non più di 50 caratteri\\
        \hline
        Nuovo codice di accesso & Semplice & Alto & Input & \hyperlink{R3NF}{R3NF}, Non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\textbf{Visualizzazione statistiche  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Entrate evento & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Nome evento & Semplice & Basso & Output & \\
        Entrate totali & Semplice & Basso & Output & \\
        \hline
        Guadagni evento & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Nome evento & Semplice & Basso & Output & \\
        Guadagni totali & Semplice & Basso & Output & \\
        \hline
        Entrate membro & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Membro associato & Semplice & Basso & Output & \\
        Entrate totali & Semplice & Basso & Output & \\
        \hline
        Guadagni membro & Complesso & Basso & Output & \\
        \textbf{Composto da:} & & & & \\
        Membro associato & Semplice & Basso & Output & \\
        Guadagni totali & Semplice & Basso & Output & \\
        \hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\newpage

\textbf{Gestione eventi  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Evento & Complesso & Medio & Input & \hyperlink{R18F}{R18F}, \hyperlink{R19F}{R19F} \\
        \textbf{Composto da:} & & & & \\
        Nome & Semplice & Medio & Input & \\
        Descrizione & Semplice & Medio & Input & \\
        Periodo temporale & Semplice & Medio & Input & \\
        Luogo & Semplice & Medio & Input & \\
        \hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Gestione tipologie prevendite  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Tipologia prevendita & Complesso & Medio & Input & \hyperlink{R20F}{R20F} \\
        \textbf{Composto da:} & & & & \\
        Nome & Semplice & Medio & Input & \\
        Descrizione & Semplice & Medio & Input & \\
        Periodo temporale & Semplice & Medio & Input & \\
        Prezzo & Semplice & Medio & Input & \\
        \hline
        Evento scelto & Semplice & Medio & Input & \\
        \hline
    \end{tabularx}
\end{center}

\textbf{Autenticazione  - Tabella Informazioni/Flusso}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|X|}
        \hline
        \textbf{Informazione} &\textbf{Tipo} & \textbf{Livello protezione / Privacy} & \textbf{Input/Output} & \textbf{Vincoli}\\
        \hline
        \hline
        Username & Semplice & Alto & Input & Non più di 20 caratteri\\
        \hline
        Password & Semplice & Alto & Input & \hyperlink{R2NF}{R2NF}, non più di 50 caratteri\\
        \hline
    \end{tabularx}
\end{center}

\subsection{Analisi dei vincoli}
\subsubsection{Tabella dei vincoli}


%\hyperlink{R22NF}{R22NF} I dati della comunicazione devono essere protetti.
%\hyperlink{R23NF}{R23NF} I dati persistenti devono essere protetti
%\hyperlink{R24NF}{R24NF} Il sistema deve verificare le autorizzazioni degli utenti e dei membri.

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|l|X|X|}
    \hline
    \textbf{Requisito} & \textbf{Categoria} & \textbf{Impatto} & \textbf{Funzionalità}\\
    \hline
    \hline
    Facile navigabilità delle schermate (\hyperlink{R21NF}{R21NF} & Usabilità & Cercare di migliorare & Gestione vendite prevendita,  Gestione entrata, Autenticazione\\
    \hline
    Protezione dei dati (\hyperlink{R22NF}{R22NF}, \hyperlink{R23NF}{R23NF}) & Sicurezza & Peggiorano tempo di risposta, migliorano la privacy dei dati & Gestione log, Scrittura log, Sblocco utente, Registrazione utente, Crea staff, Accedi staff, Cambia password, Visualizzazione statistiche personali, Gestione vendita prevendita, Gestione entrata, Gestione membri, Cambia codice accesso, Visualizzazione statistiche, Gestione eventi, Gestione tipologie prevendite, Autenticazione\\
    \hline
    Controllo accessi (\hyperlink{R24NF}{R24NF}) & Sicurezza & Peggiorano tempo di risposta e usabilità, migliorano la privacy dei dati & Gestione utente, Gestione amministrazione\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\subsection{Analisi delle interazioni}
\subsubsection{Tabella delle maschere}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Maschera} & \textbf{Informazioni} & \textbf{Funzionalità}\\
    \hline
    \hline
    View Autenticazione & Username, password & Autenticazione\\
    \hline
    Home Gestione Amministrazione & Navigabilità delle funzioni amministratore di sistema & Gestione Amministrazione\\
    \hline
    Home Gestione log & Navigabilità delle funzioni gestione log: aggiungi log e leggi log & Gestione log\\
    \hline
    View Aggiungi log & Timestamp, descrizione, livello & Gestione log\\
    \hline
    View Leggi log & Timestamp, descrizione, livello & Gestione log\\
    \hline
    View Sblocco utente & Dati utente da sbloccare & Sblocco utente \\
    \hline
    View Registrazione utente & Nome, cognome, telefono, username, password & Registrazione utente\\
    \hline
    Home Gestione utente & Navigabilità delle funzioni utente, scelta staff & Gestione utente\\
    \hline
    View Crea staff & Nome, codice di accesso & Crea staff\\
    \hline
    View Accedi staff & Nome, codice di accesso & Accedi staff\\
    \hline
    View Cambia password & Vecchia password, nuova password & Cambia password\\
    \hline
    Home Gestione staff & Consente la navigabilità delle funzioni del membro, PR, cassiere e amministratore, scelta evento & Gestione amministrazione staff, Gestione entrata, Gestione vendita prevendita, Visualizza statistiche personali\\
    \hline
    View Visualizzazione statistiche personali & Entrate svolte, guadagni, filtri dei dati per evento, staff e totale & Visualizzazione statistiche personali\\
    \hline
    Home Gestione vendita prevendita & Navigabilità tra le funzioni del PR & Gestione vendita prevendita\\
    \hline
    View Aggiungi prevendita & Informazioni cliente, evento prevendita, tipologia prenvendita, documento finale & Gestione vendita prevendita\\
    \hline
    View Lista prevendite & Informazioni cliente, evento e tipologia, filtri in base al cliente e all'evento & Gestione vendita prevendita\\
    \hline
    View Annulla prevendita & Informazioni prevendita per l'annullamento & Gestionve vendita prevendita\\
    \hline
    Home Gestione entrata & Fornisce la navigabilità tra le funzioni del Cassiere & Gestione entrata\\
    \hline
    View Timbra entrata & Documento digitale & Gestione entrata\\
    \hline
    View Lista entrate & Entrata, filtri per evento, staff & Gestione entrata\\
    \hline
    Home gestione membri & Fornisce la navigabilità tra le funzioni di gestione dei membri da parte dell'amministratore & Gestione membri\\
    \hline
    View lista membri & Informazioni sui membri & Gestione membri\\
    \hline
    View Modifica ruoli membro & Informazioni del membro da modficare, nuovi ruoli & Gestione membri\\
    \hline
    View Rimuovi membro & Informazioni del membro da eliminare & Gestione membri\\
    \hline
    View Cambia codice di accesso & Nome staff, vecchio codice, nuovo codice & Cambia codice accesso\\
    \hline
    View Visualizzazione statistiche & Informazioni membro, entrate effettuate, guadagni, informazioni evento, entrate evento, guadagni evento, filtro per membro o per evento & Visualizzazione statistiche\\
    \hline
    \end{tabularx}
\end{center}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Maschera} & \textbf{Informazioni} & \textbf{Funzionalità}\\
    \hline
    \hline
    Home Gestione eventi & Fornisce la navigabilità tra le funzioni di gestione eventi da parte dell'amministratore & Gestione eventi \\
    \hline
    View Aggiungi evento & Nome, descrizione, periodo temporale e luogo di svolgimento & Gestione eventi\\
    \hline
    View Lista eventi & Nome, descrizione, periodo temporale e luogo di svolgimento & Gestione eventi\\
    \hline
    View Modifica evento & Informazioni dell'evento da modificare, modifiche da effettuare & Gestione eventi\\
    \hline
    View Annulla evento & Informazioni dell'evento da annullare & Gestione eventi\\
    \hline
    Home Gestione tipologie prevendite & Fornisce la navigabilità tra le funzioni di gestione tipologie prevendite da parte dell'amministratore & Gestione tipologie prevendite \\
    \hline
    View Aggiungi tipologia prevendita & Nome, descrizione, periodo temporale di vendita e prezzo & Gestione tipologie prevendite\\
    \hline
    View Lista tipologie prevendite & Nome, descrizione, periodo temporale di vendita e prezzo & Gestione tipologie prevendite\\
    \hline
    View Modifica tipologia prevendita & Informazioni della tipologia prevendita da modificare, modifiche da effettuare & Gestione tipologie prevendite\\
    \hline
    View Elimina tipologia prevendita & Informazioni della tipologia prevendita da eliminare & Gestione tipologie prevendite\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\subsection{Analisi dei ruoli e responsabilità}
\subsubsection{Tabella dei ruoli}


\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|X|X|}
    \hline
    \textbf{Ruolo} & \textbf{Responsabilità} & \mc{2}{\textbf{Maschere}} & \textbf{Riservatezza} & \textbf{Numerosità}\\
    \hline
    \hline
    Utente & Può creare uno staff, e accedere ad altri staff. & \mc{2}{View Autenticazione, Home Gestione utente, View Crea staff, View Accedi staff, View Cambia password} & Alto grado di riservatezza & Il numero può essere gestito da un amministratore di sistema, al più è limitato dalle risorse del sistema. \\ 
    \hline
    Amministratore di sistema & Gestisce il log, lo sblocco di utenti bloccati e la registrazione di un nuovo utente. & \mc{2}{View Autenticazione, Home Gestione Amministrazione, Home gestione log, View Aggiungi log, View Leggi Log, View Sblocco utente, View Registrazione utente} & Massimo grado di riservatezza & Per ogni installazione software è sufficiente un amministratore di sistema.\\
    \hline
    Membro di uno staff & Può ricavare informazioni sullo staff, può leggere le statistiche ad esso attribuite. & \mc{2}{Home gestione staff, View Visualizzazione statistiche personali} & Alto grado di riservatezza & Numero massimo limitato dalle risorse del sistema. \\
    \hline
    Cassiere di uno staff & Può effettuare tutte le operazioni di un membro e in più gestisce le entrate di un evento. & \mc{2}{Home gestione staff, View Visualizzazione statistiche personali, Home Gestione entrata, View Timbra entrata, View lista entrate} & Alto grado di riservatezza & Numero massimo limitato dalle risorse del sistema.\\
    \hline
    PR di uno staff & Può effettuare tutte le operazioni di un membro e in più gestisce la vendita di prevendite. & \mc{2}{Home gestione staff, View Visualizzazione statistiche personali, Home Gestione vendita prevendita, View Aggiungi prevendita, View Lista prevendite, View Annulla prevendita} & Alto grado di riservatezza & Numero massimo limitato dalle risorse del sistema.\\
    \hline
    Amministratore di uno staff & Può effettuare tutte le operazioni di un membro e in più gestisce lo staff. & \mc{2}{Home gestione staff, View Visualizzazione statistiche personali, Home Gestione membri, View lista membri, View Modifica ruoli membro, View Rimuovi membro, View Cambia codice di accesso, View Visualizzazione statistiche, Home Gestione eventi, View Aggiungi evento, View lista eventi, View Modifica evento, View Annulla evento, Home gestione tipologie prevendite, View Aggiungi tipologia prevendita, View lista tipologie prevendite, View modifica tipologia prevendita, View elimina tipologia prevendita} & Alto grado di riservatezza & Numero massimo limitato dalle risorse del sistema.\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\subsubsection{Tabelle Ruolo-Informazioni}

\textbf{Utente: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Password personale & Scrittura\\
    \hline
    Staff & Lettura/Scrittura\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Amministratore di sistema: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Password personale & Scrittura\\
    \hline
    Utente & Lettura/Scrittura\\
    \hline
    Log & Lettura/Scrittura\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Membro di uno staff: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Informazioni sullo staff & Lettura\\
    \hline
    Statistiche personali & Lettura\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Cassiere staff: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Informazioni sullo staff & Lettura\\
    \hline
    Statistiche personali & Lettura\\
    \hline
    Prevendite & Lettura\\
    \hline
    Entrate & Lettura/Scrittura\\
    \hline
    Tipologie prevendita & Lettura\\
    \hline
    Evento & Lettura\\
    \hline
    \end{tabularx}
\end{center}

\textbf{PR di uno staff: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Informazioni sullo staff & Lettura\\
    \hline
    Statistiche personali & Lettura\\
    \hline
    Prevendite & Lettura/Scrittura\\
    \hline
    Tipologie prevendita & Lettura\\
    \hline
    Evento & Lettura\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Amministratore di uno staff: Tabella Ruolo-Informazioni}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Informazione} & \textbf{Tipo di accesso} \\
    \hline
    \hline
    Dati personali & Lettura\\
    \hline
    Informazioni sullo staff & Lettura\\
    \hline
    Statistiche personali & Lettura\\
    \hline
    Evento & Lettura/Scrittura\\
    \hline
    Tipologie Prevendite & Lettura/Scrittura\\
    \hline
    Statistiche & Lettura\\
    \hline
    Codice di accesso & Scrittura\\
    \hline
    Membri dello staff & Lettura/Scrittura\\
    \hline
    Ruoli di un membro & Lettura/Scrittura\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\subsection{Scomposizione del problema}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
    \hline
    \textbf{Funzionalità} & \textbf{Scomposizione} \\
    \hline
    \hline
    Gestione Amministrazione & Gestione log, Sblocco utente, Registrazione utente\\
    \hline
    Gestione log & Leggi log, Aggiungi log\\
    \hline
    Gestione utente & Crea staff, Accedi staff, Cambia password\\
    \hline
    Gestione Amministrazione staff & Gestione membri, Cambia codice accesso, Visualizzazione statistiche, Gestione eventi, Gestione tipologie prevendita\\
    \hline
    Gestione vendita prevendita & Aggiungi prevendita, Lista prevendite, Annulla prevendita\\
    \hline
    Gestione entrata & Timbra entrata, Lista entrate\\
    \hline
    Gestione membri & Lista membri, Modifica ruoli membro, Rimuovi membro\\
    \hline
    Gestione eventi & Aggiungi evento, Lista eventi, Modifica evento, Annulla evento\\
    \hline
    Gestione tipologie prevendita & Aggiungi tipologia prevendita, Lista tipologie prevendita, Modifica tipologia prevendita, Rimuovi tipologia prevendita\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione Amministrazione: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Registrazione utente & Sblocco utente & Si può sbloccare un utente solo se è registrato & Username\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione log: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Aggiungi log & Leggi log & Si può leggere un record solo se è stato aggiunto & Record\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione utente: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Crea staff & Accedi staff & Si può accedere ad uno staff solo se è stato creato & Nome staff\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione amministrazione staff: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    %Gestione vendita prevendita & Gestione eventi & La gestione vendita prevendita deve poter leggere gli eventi per inserirlo nella prevendita & Eventi\\
    %\hline
    %Gestione vendita prevendita & Gestione tipologie prevendita & La gestione vendita prevendita deve poter leggere le tipologie prevendita per l'associazione alla prevendita & Tipologie prevendita\\
    %\hline
    %Gestione vendita prevendita & Gestione entrata & Non posso annullare una prevendita se è già stata usata & Prevendita\\
    %\hline
    Gestione tipologie prevendita & Gestione eventi & Non posso creare una tipologia prevendita con un periodo di vendita durante o dopo l'evento (\hyperlink{R9NF}{R9NF}) & Evento\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\textbf{Gestione vendita prevendita: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Aggiungi prevendita & Lista prevendite & La lista delle prevendite è condizionata dalle prevendite aggiunte & Prevendita\\
    \hline
    Aggiungi prevendita & Annulla prevendita & Si può annullare una prevendita solo se è stata aggiunta & Prevendita\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione entrata: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Timbra Entrata & Lista entrate & La lista delle entrate è condizionata dalle entrate aggiunte & Entrata\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione membri: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Lista membri & Rimuovi membro & Posso eliminare un membro solo se fa parte della lista, cioè dello staff & Membro\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione eventi: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Aggiungi evento & Lista eventi & La lista delle prevendite è condizionata dalle prevendite aggiunte & Prevendita\\
    \hline
    Aggiungi prevendita & Annulla prevendita & Si può annullare una prevendita solo se è stata aggiunta & Prevendita\\
    \hline
    \end{tabularx}
\end{center}

\textbf{Gestione tipologie prevendita: Tabella Sotto-Funzionalità}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Sotto-funzionalità} & \textbf{Sotto-funzionalità} & \textbf{Legame} & \textbf{Informazioni}\\
    \hline
    \hline
    Aggiungi tipologia prevendita & Lista tipologie prevendita & La lista delle tipologie prevendita è condizionata dalle tipologie prevendita aggiunte & Tipologia prevendita\\
    \hline
    Aggiungi tipologie prevendita & Annulla tipologie prevendita & Si può annullare una tipologie prevendita solo se è stata aggiunta & Tipologia prevendita\\
    \hline
    \end{tabularx}
\end{center}

\newpage

\subsection{Creazione del modello del dominio}

Analizzando il vocabolario si evidenzia la differenza tra utente normale e amministratore di sistema, e i vari ruoli di un membro, che possono essere cassiere, pr o amministratore.\\Dall'analisi del vocabolario, rivisto dopo l'analisi di sicurezza, si evidenzia anche il log, con i livelli di importanza: basso, medio, alto.\\\textbf{Qui sotto il modello del dominio:}\\

%Chiedere se le molteplicità cambiano nella progettazione: Solo se c'è differenza di navigabilità

%username password messe qui ma in progettazione tolte

%\begin{center}
%    \includegraphics[scale=0.68]{modello_dominio.png}
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=0.68]{Analisi/modello_dominio.png}
    \centering
    \caption{modello\_dominio.vsdx}
\end{figure}

Le credenziali dovranno essere gestite in maniera sicura, nella fase di progettazione. L'aggiunta del \textbf{telefono} alle entità Utente e AmministratoreDiSistema garantisce flessibilità per una futura implementazione \textbf{OTP}.

\newpage

\subsection{Architettura logica}

\subsubsection{Diagramma dei package}

%\begin{center}
%    \includegraphics[scale=0.8]{diagramma_package.png}    
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=0.8]{Analisi/Diagrammi_Package/diagramma_package.png}
    \centering
    \caption{diagramma\_package.vsdx}
\end{figure}

%Il controller autenticazione utilizza le altre interfacce perché le deve invocare!

\newpage

\subsubsection{Diagramma delle classi}

\textbf{Diagramma delle classi: Gestione Amministrazione}

\begin{figure}[H]
    \includegraphics[scale=0.55]{Analisi/Diagrammi_Classi/diagramma_classi_gestione_amministrazione.png}
    \centering
    \caption{diagramma\_classi\_gestione\_amministrazione.vsdx}
\end{figure}

\textbf{Gestione Amministrazione Controller} si occupa di gestire le operazioni associate all'amministratore di sistema. Abbiamo ritenuto utile separare \textbf{Gestione Amministrazione Controller} e \textbf{Gestione Log Controller} per rispettare la scomposizione del problema vista precedentemente.

\newpage

\textbf{Diagramma delle classi: Gestione Utente}

%\begin{center}
%    \includegraphics[scale=0.50]{diagramma_classi_gestione_utente.png}    
%\end{center}

\begin{figure}[H]
    \includegraphics[scale=0.65]{Analisi/Diagrammi_Classi/diagramma_classi_gestione_utente.png}
    \centering
    \caption{diagramma\_classi\_gestione\_utente.vsdx}
\end{figure}

\textbf{Gestione Utente Controller} si occupa di gestire le operazioni associate agli utenti.

\newpage

\textbf{Diagramma delle classi: Gestione Staff}

\begin{figure}[H]
    \includegraphics[scale=0.4]{Analisi/Diagrammi_Classi/diagramma_classi_gestione_staff_interfacce.png}
    \centering
    \caption{diagramma\_classi\_gestione\_staff\_interfacce.vsdx}
\end{figure}

Le interfacce sono molte, visto le operazioni effettuabili nel sistema gestionale. Abbiamo separato le interfacce dai controller per evitare di confondere la lettura. Le interfacce sono comunque collegate ai relativi controller.

\begin{figure}[H]
    \includegraphics[scale=0.65]{Analisi/Diagrammi_Classi/diagramma_classi_gestione_staff.png}
    \centering
    \caption{diagramma\_classi\_gestione\_staff.vsdx}
\end{figure}

\textbf{Gestione Staff Controller} si occupa della parte di gestione dello staff. Usato dai membri di uno staff per le varie operazioni, è stato diviso in base alle interfacce. 


\newpage

\textbf{Diagramma delle classi: Autenticazione}

\begin{figure}[H]
    \includegraphics[scale=0.8]{Analisi/Diagrammi_Classi/diagramma_classi_autenticazione.png}
    \centering
    \caption{diagramma\_classi\_autenticazione.vsdx}
\end{figure}

\textbf{Autenticazione Controller} gestisce la sessione di un utente; permette di tenere traccia anche del contesto attuale dell'utente. Per esempio, nella fase progettuale si potrebbe sfruttare per tenere traccia dello staff e dell'evento in uso dall'utente, semplificando la presentazione.

\newpage

\subsubsection{Interazione}

Saranno riportati solo i diagrammi di sequenza ritenuti principali per il sistema di gestione prevendite.

\textbf{Diagramma di sequenza: Autenticazione con successo}

\begin{figure}[H]
    \includegraphics[scale=0.75]{Analisi/Diagrammi_Sequenza/diagramma_sequenza_autenticazione.png}
    \centering
    \caption{diagramma\_sequenza\_autenticazione.vsdx}
\end{figure}

Una volta effettuato il logout si richiede di nuovo l'autenticazione tramite \textbf{View Autenticazione}. Effettuato l'accesso, si passa alla schermata di \textbf{Home Gestione Utente} o \textbf{Home Gestione Amministrazione} in caso di amminstratore di sistema. 

\textbf{Diagramma di sequenza: Registrazione utente}

\begin{figure}[H]
    \includegraphics[scale=0.65]{Analisi/Diagrammi_Sequenza/diagramma_sequenza_registrazione_utente.png}
    \centering
    \caption{diagramma\_sequenza\_registrazione\_utente.vsdx}
\end{figure}

Prima della registrazione la persona non è nota al sistema e non può interagire con esso direttamente. Abbiamo inserito un \textbf{loop} perché probabilmente la registrazione avviene per staff, evitando l'autenticazione ripetuta.

\newpage

\textbf{Diagramma di sequenza: Creazione evento}

\begin{figure}[H]
    \includegraphics[scale=0.65]{Analisi/Diagrammi_Sequenza/diagramma_sequenza_creazione_evento.png}
    \centering
    \caption{diagramma\_sequenza\_creazione\_evento.vsdx}
\end{figure}

\textbf{Diagramma di sequenza: Vendita prevendita}

\begin{figure}[H]
    \includegraphics[scale=0.6]{Analisi/Diagrammi_Sequenza/diagramma_sequenza_vendita_prevendita.png}
    \centering
    \caption{diagramma\_sequenza\_vendita\_prevendita.vsdx}
\end{figure}

Il cliente non può interfacciarsi direttamente al sistema, infatti è richiesto il PR per la gestione della vendita della prevendita. Quando il PR ha interagito con il sistema, consegna al cliente il \textbf{documento digitale} che rappresenta la prevendita. Abbiamo deciso di aggiungere un \textbf{loop} perché è probabile che il PR venda ad un gruppo di persone alla volta, evitando di effettuare l'autenticazione ogni volta.

\newpage

\textbf{Diagramma di sequenza: Ingresso evento}

\begin{figure}[H]
    \includegraphics[scale=0.55]{Analisi/Diagrammi_Sequenza/diagramma_sequenza_ingresso_evento.png}
    \centering
    \caption{diagramma\_sequenza\_ingresso\_evento.vsdx}
\end{figure}

Il cassiere \textbf{ripete} l'operazione di timbratura delle prevendite per tutta la durata necessaria durante l'evento. Qui il \textbf{loop} è d'obbligo data la natura del cassiere. Il documento permette di timbrare la prevendita, la quale si trasforma in \textbf{Prevendita Timbrata} come nel modello del dominio.

\newpage

\subsubsection{Comportamento}

Dopo un'attenta analisi, abbiamo deciso di mostrare i diagrammi di stato riguardo un \textbf{evento} ed una \textbf{prevendita}, sempre basandoci sui requisiti.

%R19F - Un evento puo essere annullato, anche se ci sono prevendite vendute.
%R21F - Una prevendita puo essere annullata e/o rimborsata.

%R9NF - Il periodo di vendita delle prevendite deve essere antecedente il periodo dell’evento.
%R10NF - Una prevendita annullata e/o rimborsata rimane tale
%R11NF - Un evento annullato rimane tale
%R14NF - Ogni prevendita venduta `e associata ad una sola tipologia di prevendita
%R15NF - La tipologia di prevendita associata non `e modificabile
%R16NF - Il prezzo di una tipologia di prevendita `e modificabile solo se non sono state vendute prevendite conquella determinata tipologia
%R20NF - La timbratura puo essere fatta solo una volta

\textbf{Diagramma di Stato: Evento}

\begin{figure}[H]
    \includegraphics[scale=1]{Analisi/Diagrammi_Stato/diagramma_stato_evento.png}
    \centering
    \caption{diagramma\_stato\_evento.vsdx}
\end{figure}

Secondo le specifiche \hyperlink{R19F}{R19F} e \hyperlink{R11NF}{R11NF}, un evento può essere \textbf{annullato}, mentre lo stato \textbf{Concluso} si deduce dal requisito \hyperlink{R18F}{R18F} in quanto un evento ha un periodo di svolgimento.\\

\textbf{Diagramma di Stato: Prevendita}

\begin{figure}[H]
    \includegraphics[scale=1]{Analisi/Diagrammi_Stato/diagramma_stato_prevendita.png}
    \centering
    \caption{diagramma\_stato\_prevendita.vsdx}
\end{figure}

Secondo le specifiche \hyperlink{R21F}{R21F} \hyperlink{R10NF}{R10NF} una prevendita può essere \textbf{annullata} e \textbf{rimborsata}, mentre dai requisiti \hyperlink{R12F}{R12F} \hyperlink{R20NF}{R20NF} si deduce lo stato \textbf{Timbrata}, in accordo con il diagramma di sequenza di ingresso evento.

\newpage

\subsection{Piano del lavoro}

Il lavoro di gruppo è stato diviso in base alle competenze dei membri del team. Si prevede un team per lo sviluppo del database e uno per una possibile applicazione middleware da inserire tra database e applicativo finale. \textbf{Tutti i dettagli nella tabelle sottostanti}:

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|}
        \hline
        \textbf{Nome Team} & \textbf{Composizione}\\
        \hline
        \hline
        Team progettazione & Bartolomei, di Nuzzo, Veronesi\\
        \hline
        Team sviluppo DB & Bartolomei, Veronesi\\
        \hline
        Team sviluppo Middleware & Bartolomei, di Nuzzo\\
        \hline
        Team sviluppo front-end & di Nuzzo, Veronesi\\
        \hline
        Team sicurezza & Bartolomei, di Nuzzo, Veronesi\\
        \hline
    \end{tabularx}
\end{center}

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|X|}
    \hline
    \textbf{Package} & \textbf{Progetto} & \textbf{Sviluppo}\\
    \hline
    \hline
    Dominio & Team progettazione & Team sviluppo DB, Team sicurezza  \\
    \hline
    GestioneAmministrazione & Team progettazione & Team sviluppo Middleware\\
    \hline
    GestioneUtente & Team progettazione & Team sviluppo Middleware\\
    \hline
    GestioneStaff & Team progettazione & Team sviluppo Middleware\\
    \hline
    Autenticazione & Team progettazione & Team sviluppo DB, Team sviluppo Middleware, Team sicurezza\\
    \hline
    Log & Team progettazione & Team sviluppo DB, Team sviluppo Middleware, Team sicurezza\\
    \hline
    InterfacciaGestioneAmministrazione & Team progettazione & Team sviluppo front-end \\
    \hline
    InterfacciaGestioneUtente & Team progettazione & Team sviluppo front-end \\
    \hline
    InterfacciaGestioneStaff & Team progettazione & Team sviluppo front-end\\
    \hline
    InterfacciaAutenticazione & Team progettazione & Team sviluppo front-end, Team sicurezza\\
    \hline
    \end{tabularx}
\end{center}

Dopo una dovuta valutazione, i tempi di rilascio previsti sono i seguenti:

\begin{itemize}
    \item \textbf{Progettazione}: entro 14 giorni dalla data odierna.
    \item \textbf{Sviluppo moduli con test unitari}: entro 21 giorni dalla fine di progetto odierna.
    \item \textbf{Integrazione e testing}: Entro 7 giorni dalla fine dello sviluppo dei moduli.
\end{itemize}

\subsubsection{Sviluppi futuri}

Il committente ha richiesto una flessibilità nell'applicazione per quanto riguarda \textbf{l'utilizzo di nuove tipologie dei documenti digitali}, in modo da andare incontro a nuove tecnologie applicabili. Per esempio una valida proposta, già discussa con il committente, è l'utilizzo di QR code come documento digitale. Non è da escludere che in futuro si possa usare una tecnologia alternativa per migliorare la qualità del servizio. L'introduzione di un numero di telefono per gli utenti e per l'amministratore di sistema, potrebbe permettere l'introduzione di un'\textbf{autenticazione a due fattori} con password \textbf{OTP}.  

\newpage

\subsection{Piano di collaudo}

Per garantire il funzionamento del sistema sono necessari una gamma di test unitari e
di integrazione che permettono di verificare la correttezza delle singole parti.

\lstinputlisting[language=Java]{Analisi/Test/TestEvento.java}
\lstinputlisting[language=Java]{Analisi/Test/TestPrevendita.java}

\newpage

\section{Progettazione}

\subsection{Progettazione architetturale}

\subsubsection{Requisiti non funzionali}

Dall’analisi dei requisiti sono emersi alcuni vincoli non funzionali, tra cui:

\begin{itemize}
    \item Integrità dati
    \item Sicurezza dati, anche nella comunicazione
    \item Controllo accessi
    \item Controllo autorizzazioni
    \item Disponibilità del servizio
    \item Replicabilità del sistema
    \item \textbf{basso costo del prodotto software}
    \item Facilità d’utilizzo
\end{itemize}

L'integrità e la sicurezza dei dati, soprattutto per quanto riguarda la comunicazione, sono di fondamentale importanza, soprattutto in vista di una architettura 3-tier. Purtroppo, dato il basso costo di sviluppo software, è opportuno scegliere soluzioni standard esterne al sistema, come l'uso di protocolli di cifratura come il TLS, il quale viene utilizzato da protocolli più di alto livello come HTTPS, che abbiamo deciso di utilizzare data la facilità d'utilizzo e il vasto supporto. L'avvento di tecnologie di trasmissione di dati moderne rende più che abbordabile l'utilizzo di tecnologia di cifratura. Inoltre l'utilizzo di uno standard già implementato e testato da terze parti riduce il rischio di sicurezza dovuto a difetti all'interno del nostro prodotto software.\\Il controllo degli accessi rappresenta una opportuna soluzione per la garantire il sistema a fronte di malintenzionati. L'uso di un controllo delle autorizzazioni favorisce a separare i ruoli e a migliorare la sicurezza, probabilmente perdendo in facilità d'utilizzo.\\La Disponibilità del servizio e la Replicabilità del sistema servono a garantire i requisiti \hyperlink{R25NF}{R25NF} \hyperlink{R26NF}{R26NF}, per contenere un attacco DoS: questi vincoli potrebbero essere in conflitto con la strutturazione di un'architettura client/server, si cerca quindi un trade-off tra disponibilità e architettura.


\subsection{Scelta dell'architettura}
Abbiamo optato per una architettura client/server a tre livelli: un database, un software middleware e un applicativo front-end. L'applicazione middleware fa da intermediario tra il database e l'applicativo lato cliente. Questa scelta rende facile l'implementazione di applicativi front-end multipiattaforma e specializzati: si potranno avere quindi più applicativi front-end adatti al lavoro dello specifico utilizzatore finale.

\subsubsection{Livello di Persistenza}
Abbiamo deciso di adottare un database relazionale indipendente per la persistenza dei dati. Inoltre abbiamo capito che il software di gestione ha dei momenti di picco: per esempio durante l'entrata ad un evento si generano molte richieste. Vista la natura del software gestionale, l'utilizzo di modelli di persistenza integrata dell'applicazione middleware potrebbe scaturirsi in basse prestazioni. Inoltre, l'utilizzo di un database indipendente permette anche una scalabilità orizzontale del parco middleware, favorendo la disponiblità del servizio (\hyperlink{R25NF}{R25NF}), ma limitando la replicabilità del sistema in locale (\hyperlink{R26NF}{R26NF}) nel caso in cui il database non sia accessible all'esterno. Il problema si può affrontare creando uno "scatto" del database, prima dell'inizio dell'evento, risolvendo localmente così il problema riscontrato nell'analisi del rischio.\\La persistenza dei log viene gestita attraverso file.


\subsubsection{Livello Middleware}
Le funzionalità di questo livello sono pensate per facilitare lo sviluppo multipiattaforma centralizzato, sfruttando una comunicazione con la controparte front-end. Si tratta dell'unico livello che può interagire con il livello di persistenza, e nel caso ci siano vincoli non direttamente implementabili nel progetto del database, saranno implentati qui, senza il rischio che una terza applicazione che utilizza il database, non implementi tali vincoli, rendendo intrinsecamente più semplice la struttura del front-end.

\subsubsection{Livello Front-end}
Si tratta dell'ultimo livello, quello a contatto con gli utilizzatori finali, specializzato nel rappresentare le informazioni reperite dallo strato server intermedio. Il livello è pensato per essere altamente specializzato e multipiattaforma: un'implementazione può sfruttare la piattaforma sottostante e reperire le informazioni in maniera più rapida. Inoltre si potrebbero introdurre diverse implementazioni, a seconda dell'utilizzatore finale.\\


\subsubsection{Patterns \& Design Principle}
Abbiamo adottato il pattern \textbf{Broker}, che rende facile la scalabilità orizzontale dello strato intermedio, facilitando anche il compito di replicazione locale in caso di necessità. Tale scelta, inoltre, permette di applicare \textbf{The Dependency Inversion Principle} disaccoppiando i client dallo specifico middleware, dato che viene definito a priori il protocollo di comunicazione.\\Abbiamo deciso di adottare il pattern architetturale \textbf{MVP} per l'applicativo middleware, mentre per la parte front-end si è utilizzato il \textbf{MVVM}. Il software middleware avrà una parte di view minima, \textbf{passiva}, volta solo alla comunicazione lato front-end, mentre il software front-end sarà decisamente più orientato alla presentazione e avente meno business logic.

%\subsubsection{Diagramma a package}

%Da chiedere dove mettere il protocollo di comunicazione tra middleware e front-end: Va in implementazione


%Nella figura sottostante è riportata l’Architettura del Sistema organizzata attraverso un diagramma dei package:\\

%\begin{figure}[H]
%    \includegraphics[scale=0.55]{Progettazione/diagramma_architettura_logica_package.png}
%    \centering
%    \caption{diagramma\_architettura\_logica\_package.vsdx}
%\end{figure}

%\newpage

\subsubsection{Diagramma a componenti}

\begin{figure}[H]
    \includegraphics[scale=0.55]{Progettazione/diagramma_architettura_logica_componenti.png}
    \centering
    \caption{diagramma\_architettura\_logica\_componenti.vsdx}
\end{figure}

\subsubsection{Scelte tecnologiche}
Abbiamo deciso di utilizzare come protocollo di sicurezza e trasmissione dei dati il protocollo \textbf{HTTPS}: la sicurezza è garantita dal layer TLS, che assicura una comunicazione sicura end-to-end, inoltre l'ampio bacino di utilizzatori del protocollo permette la produzione di un prodotto software versatile: un possibile servizio esterno potrebbe interfacciarsi con l'applicativo middleware, senza riscontrare troppe difficoltà.\\Per il formato dei dati abbiamo scelto \textbf{JSON}, dato il grande supporto e la sua facilità di utilizzo.

\newpage

\subsection{Progettazione di dettaglio}

%Chiedere la divisione di package in base al livello middleware o front-end: si
%Chiedere come definire lo scambio dei dati tra middleware e front-end: implementazione
%Chiedere se aggiungere le chiavi del db nel dominio: Si
%Chiedere se gli oggetti delle relazioni vanno esplicitate nella progettazione: no

\subsubsection{Struttura}

I cambiamenti del dominio seguente rispetto a quello dell’analisi del problema sono dovuti
alla decisione di \textbf{dividere il software} in strato middleware e strato front-end. Inoltre, i cambiamenti sono imposti dalla scelta di utilizzare i Design Pattern \textbf{MVP} e \textbf{MVVM}.

\subsubsection{Struttura middleware}

%da chiedere se MVP o MVC: MVP circa non bisogna essere rigidi

Come detto in precedenza, la struttura è basata su \textbf{MVP}.

\begin{itemize}
    \item \textbf{Model}: Si tratta della parte che gestisce il database.\\Utilizzando il pattern \textbf{DAO}, si crea il mapping delle relazioni con gli oggetti.\\Non viene utilizzato il pattern \textbf{Proxy} per implementare il \textbf{lazy-load}: dato che le richieste al middleware sono definite a priori, si conosce esattamente quali dati reperire, potendo usufruire del \textbf{JOIN} fornito dal DBMS.\\Per l'interazione con i log si è preferito un accesso diretto a file, sempre con un accesso tramite pattern \textbf{DAO}.
    \item \textbf{View}: Gestisce la risposta al client, formattando i dati nel formato JSON, si tratta di una vista \textbf{passiva}.
    \item \textbf{Presenter}: Collante tra Model e View, con tutta la business logic di supporto.
\end{itemize}

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.model.dao

%Factory DAO Generale
%Factory DAO per ogni sotto interfaccia: sarà il broker a fare la connessione
%Interfacce DAO Utente, DAO Amministratore di sistema, DAO Staff, DAO Membro, DAO Cassiere, DAO Amministratore.

%DAO per log da filesystem

%PersistanceException

\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/middleware/model/dao/dao_log.png}
    \centering
    \caption{dao.vsdx}
\end{figure}

Pattern \textbf{DAO} applicato alla persistenza dei log. Dato che il log è stato pensato come file, il pattern DAO viene applicato al filesystem, anche se sarebbe possibile creare un implementazione per un data source differente in una futura versione, grazie alla versatilità del pattern DAO.

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/middleware/model/dao/dao_exception.png}
    \centering
    \caption{dao.vsdx}
\end{figure}

Naturalmente gli oggetti \textbf{DAO} possono lanciare eccezioni, qui si incapsulano tali eccezioni, per migliorare la sicurezza.

\newpage

\begin{figure}[H]
    \includegraphics[scale=0.65]{Progettazione/Package/middleware/model/dao/dao_database.png}
    \centering
    \caption{dao.vsdx}
\end{figure}

Pattern \textbf{DAO} applicato alla persistenza del modello di dominio, eccetto il log, salvato su file. L'accesso al database dipende dall'implementazione che si sceglie, infatti \textbf{DatabaseConnection} è un oggetto dipendente dalla piattaforma utilizzata. L'operazione \textbf{inizializzaAmministratore} inizializza l'amministratore di sistema ai valori di default. L'operazione può essere fatta ovviamente una volta e l'amministratore dovrà poi cambiare la password di default. Le \textbf{transazioni} sono gestite all'interno delle implementazioni, a seconda dei casi d'uso. Se necessario aggiungere nell'implementazione i metodi CRUD.

%\newpage

%\paragraph{Package} it.unibo.prevenditaelettronica.middleware.dao.proxy

%lazy-load serve? NO

%Dominio che richiede proxy

%\begin{figure}[H]
%    \includegraphics[scale=0.8]{Progettazione/Package/middleware/model/dao/proxy/proxy.png}
%    \centering
%    \caption{proxy.vsdx}
%\end{figure}

%Il package fornisce classi per il \textbf{lazy-load} di alcuni metodi delle classi di dominio, utilizzando il pattern \textbf{Proxy}. La scelta dei metodi da caricare in lazy-load dipende dal caso d'uso.

%\paragraph{Package} it.unibo.prevenditaelettronica.middleware.model.log

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.model

%Modello di dominio

%TODO: chiedere le molteplicità, vedi matrimonio

\begin{figure}[H]
    \includegraphics[scale=0.65]{Progettazione/Package/middleware/model/model.png}
    \centering
    \caption{model.vsdx}
\end{figure}

Si tratta del modello di dominio visto in analisi. La maggior parte delle operazioni previste in analisi sono spostate in altri package. La gestione delle credenziali viene fatta nel package DAO e quindi il modello di dominio non contiene informazioni sulle credenziali. La generazione del documento viene fatta dal componente front-end. Rappresentano anche le classi di \textbf{DTO} per referenziare gli oggetti persistenti tramite chiavi surrogate (le chiavi da aggiungere sono viste nella progettazione della persistenza). Gli oggetti del modello di dominio vengono usati anche per trasmettere i dati ai client.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.view

%JSONSerializable
%JSONDeserializable

%PrinterInterface
%JSONPrinter

\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/middleware/view/view.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Il package it.unibo.prevenditaelettronica.middleware.view si occupa della rappresentazione dei dati verso il front-end. Data la scelta tecnologica di usare JSON come formato dati, abbiamo implementato una sola classe Printer, ma l'interfaccia rende flessibile l'utilizzo di un altro formato dati.\\L'interfaccia \textbf{JSONSerializable} non è obbligatoria, dipende dalle librerie usate in fase di implementazione, per esempio GSON non ne prevede. Nel caso in cui la serializazzione venga fatta senza aiuti esterni, l'interfaccia va implementata nelle classi di dominio, rispettando i vincoli di sicurezza.\\L'interfaccia \textbf{HTTPSInterface} serve per ricevere la richiesta e inviare la risposta. Può essere sostituita in implementazione dalla relativa classe di supporto della piattaforma scelta.\\\L'enumeratore \textbf{Stato} indica lo stato della risposta, mentre l'enumeratore \textbf{Comando} contiene tutti i comandi eseguibili sul middleware. La lista non è completa e viene riportata nel package \textbf{handler} in seguito.\\La classe \textbf{Response} rappresenta le informazioni scambiate con il client in fase di risposta: viene trasferito il \textbf{comando} per cui si è fatta la richiesta, lo stato della risposta, l'eventuale risultato o eccezione. Il risultato o l'eccezione è già serializzato, mentre l'oggetto Response verrà serializzato successivamente.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/middleware/controller/controller.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

Si tratta di un controller astratto, usato dai controller concreti mediante lo stereotipo $<<$Controller$>>$. Utilizza l'interfaccia \textbf{LogInterface} per l'append del log nel caso l'operazione concreta lo preveda. Utilizza l'interfaccia \textbf{SessioneInterface} nel caso serva accedere alla sessione corrente.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.sessione

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/middleware/controller/controller_sessione.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

La sessione viene gestita tramite pattern \textbf{Singleton}, nella classe \textbf{GestioneSessione}. Viene mostrata agli altri controller tramite l'interfaccia \textbf{SessioneInterface}. Vengono salvate le informazioni relative al modello del dominio, come l'utente o amministratore di sistema che ha effettuato il login e l'eventuale staff o evento scelto. Staff restituisce Membro, dato che abbiamo bisogno di identificare i ruoli del membro nello staff.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.autenticazione

%Chiedere se l'implemnetazione della sessione va bene. OK

%AutenticazioneController

\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/middleware/controller/controller_gestione_autenticazione.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura la parte di controller con la responsabilità di gestire la parte di autenticazione.\\L'eccezione \textbf{AuthorizationException} viene lanciata nei più svariati casi di accesso negato: credenziali errate, utente bloccato, ruolo non concesso, eccetera, e viene utilizzato anche da altri controller nel caso sia necessario.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.log

%Log

\begin{figure}[H]
    \includegraphics[scale=0.8]{Progettazione/Package/middleware/controller/controller_log.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura viene mostrato anche la parte di log interna al sistema, utilizzata dagli altri controller per aggiungere righe al log. \textbf{LogImpl} ha una DAO specializzata per l'accesso al filesystem, dato che i file di log si trovano su di esso.

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.amministrazione

%Gestione Amministrazione Controller
%Gestione Log Controller

\begin{figure}[H]
    \includegraphics[scale=0.8]{Progettazione/Package/middleware/controller/controller_gestione_amministrazione.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura la parte di controller con la responsabilità di gestire la parte di amministrazione e gestione log. \textbf{GestioneLogControllerImpl} utilizza la DAO per l'accesso ai file, dato che i log sono salvati sul file system. L'operazione \textbf{inizializzaAmministratoreDiSistema} serve durante il \textbf{deployment} del sistema: fornisce un account di amministrazione con paramentri a \textbf{default}. Non è necessario inizializzare altri dati all'interno del database, perché sarà compito dell'amministratore di sistema registrare nuovi utenti, i quali aggiungeranno tutto il necessario per il funzionamento del software gestionale.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.utente

%Gestione Utente Controller

\begin{figure}[H]
    \includegraphics[scale=0.8]{Progettazione/Package/middleware/controller/controller_gestione_utente.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura la parte di controller con la responsabilità di gestire la parte di utente.

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.controller.staff

%Gestione Staff Controller
%Gestione Entrata Controller
%Gestione Vendita Prevendite Controller
%Gestione Eventi Controller
%Gestione Tipologie Prevendita Controller
%Gestione Membri Controller

Abbiamo suddiviso il package in due diagrammi per migliorarne la lettura.

\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/middleware/controller/controller_gestione_staff_1.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura la parte di controller con la responsabilità di gestire la parte di staff. Qui viene mostrata la parte contenente \textbf{GestioneStaffController}, \textbf{GestioneVenditePrevendite} e \textbf{Gestione Entrata}. Si tratta della parte utilizzata dagli attori \textbf{PR} e \textbf{Cassiere}.\\

\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/middleware/controller/controller_gestione_staff_2.png}
    \centering
    \caption{controller.vsdx}
\end{figure}

In figura la parte di controller con la responsabilità di gestire la parte di staff. Qui viene mostrata la parte contenente \textbf{GestioneEventi}, \textbf{GestioneMembri} e \textbf{Gestione Tipologia Prevendita}. Si tratta della parte utilizzata dall'attore \textbf{Amministratore}.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.middleware.handler

%RequestHandler

\begin{figure}[H]
    \includegraphics[scale=0.70]{Progettazione/Package/middleware/handler/handler.png}
    \centering
    \caption{handler.vsdx}
\end{figure}

In figura viene mostrato il package \textbf{handler}, che si occupa di raccogliere le richieste HTTPS ed elaborarle, inoltrando la richiesta al controller opportuno. Si utilizza il pattern \textbf{State} per differenziare la presa in carico della richiesta, a seconda del comando utilizzato. L'interfaccia \textbf{HTTPSInterface} serve per ricevere la richiesta e inviare la risposta. Può essere sostituita in implementazione dalla relativa classe di supporto della piattaforma scelta. Il metodo \textbf{handleRequest} viene chiamato quando si deve gestire una richiesta, utilizzando un thread separato per ogni richiesta. La classe astratta \textbf{AbstractRequestHandler} potrebbe subire dei cambiamenti, a seconda della piattaforma sottostante. L'enumeratore \textbf{Comando} contiene tutti i comandi disponibili presso il livello middleware. L'interfaccia \textbf{JSONDeserializable} serve per convertire la richiesta JSON in oggetti utilizzabili. Può essere sostituita da un'eventuale libreria della piattaforma. La classe \textbf{Request} rappresenta le informazioni in ingresso dal client: contiene il \textbf{comando} da eseguire ed eventuali \textbf{argomenti} per la corretta esecuzione del comando, il tutto già serializzato, mentre l'oggetto Request verrà serializzato successivamente.

\newpage

Di seguito una lista dei comandi:

\begin{center}
    \begin{tabularx}{1\textwidth}{X X X}
        \textbullet REGISTRA\_UTENTE & \textbullet LOGIN  & \textbullet LOGOUT \\
        \textbullet INIZIALIZZA\_SISTEMA & \textbullet LOGIN\_SYSTEM\_ADMIN  & \textbullet CAMBIA\_PASSWORD\_ADMIN \\
        \textbullet CREA\_STAFF & \textbullet ACCEDI\_STAFF & \textbullet CAMBIA\_PASSWORD \\
        \textbullet LISTA\_STAFF & \textbullet LISTA\_MEMBRI  &  \textbullet LISTA\_EVENTI\\
        \textbullet SCEGLI\_EVENTO & \textbullet SCEGLI\_STAFF & \textbullet LISTA\_TIPOLOGIE\_PREVENDITA\\
        \textbullet AGGIUNGI\_PREVENDITA & \textbullet ANNULLA\_PREVENDITA & \textbullet RIMBORSA\_PREVENDITA \\
        \textbullet LISTA\_PREVENDITE & \textbullet STATISTICHE\_MEMBRO & \textbullet STATISTICHE\_EVENTO \\
        \textbullet LISTA\_PREVENDITE\_EVENTO & \textbullet TIMBRA\_PREVENDITA  & \textbullet CAMBIA\_CODICE\_ACCESSO \\
        \textbullet STATISTICHE\_PERSONALI & \textbullet AGGIUNGI\_EVENTO  & \textbullet ANNULLA\_EVENTO \\
        \textbullet AGGIUNGI\_TIP\_PREVENDITA & \textbullet MODIFICA\_TIP\_PREVENDITA & \textbullet ELIMINA\_TIP\_PREVENDITA \\
        \textbullet MODIFICA\_MEMBRO & \textbullet RIMUOVI\_MEMBRO &  \\
    \end{tabularx}
\end{center}

\subsubsection{Struttura front-end}

Come detto in precedenza, la struttura è basata su \textbf{MVVM}.

\begin{itemize}
    \item \textbf{Model}: Deve elaborare i dati per la ricezione/invio verso il middleware.\\L'accesso al middleware è dettato dal pattern \textbf{Broker}.
    \item \textbf{View}: Componente principale del client front-end, utilizziamo il pattern \textbf{Observer} per il binding con il ViewModel. Dovrebbe essere ridotta alla sola logica di presentazione.
    \item \textbf{ViewModel}: Collante tra Model e View, è il responsabile della logica della vista.
\end{itemize}

La modularità del \textbf{MVVM} permette di combinare facilmente le varie viste, per ottenere client veramente \textbf{personalizzati}.

\paragraph{Package}it.unibo.prevenditaelettronica.frontend.model.net.broker

%BrokerInterface
%Broker

\begin{figure}[H]
    \includegraphics[scale=0.72]{Progettazione/Package/frontend/model/net/broker/broker.png}
    \centering
    \caption{broker.vsdx}
\end{figure}

Il componente \textbf{HTTPSBrokerInterface} rappresenta un'interfaccia in grado di registrare servizi middleware, secondo una certa \textbf{priorità}. Utilizzando il metodo \textbf{procuraCanale}, il broker procura un canale per il client, in particolare andando a cercare il servizio remoto, seguendo l'ordine di priorità. L'enumeratore \textbf{ServicePriority} serve per classificare i servizi in base ad una priorità: \textbf{Primary} rappresenta il servizio principale, quello chiamato la maggior parte delle volte, \textbf{Backup} rappresenta un possibile livello middleware secondario, sempre che si riesca a scalare orizzontalmente, mentre la priorità \textbf{Local} rappresenta il backup locale effettuato dall'amministratore di sistema su richiesta, per limitare gli attacchi DoS.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.model

\begin{figure}[H]
    \includegraphics[scale=0.65]{Progettazione/Package/frontend/model/model.png}
    \centering
    \caption{model.vsdx}
\end{figure}

Il modello di dominio è uguale a quello del midde-ware, ma cambia il metodo di reperire le informazioni: nel middleware le informazioni vengono ottenute attraverso interrogazioni del database, mentre nel front-end, le informazioni vengono ottenute tramite interrogazioni del middleware. Serve quindi progettare il meccanismo di accesso al middleware. Ovviamente è possibile che le informazioni ottenute dal servizio \textbf{non siano complete}: ci si limita alle sole informazioni richieste dal comando inviato. Inoltre i vari client implementeranno solo la parte di modello \textbf{necessaria}.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.model.net

%Stato
%Comando

%AuthorizationExcepton
%PersistenceException

\begin{figure}[H]
    \includegraphics[scale=0.75]{Progettazione/Package/frontend/model/net/net_1.png}
    \centering
    \caption{net.vsdx}
\end{figure}

Molte entità sono in comune con il layer middleware. Le interfacce \textbf{JSONSerializable} e \textbf{JSONDeserializable} servono per convertire la richieste e le risposte nel formato JSON. Può essere sostituita da una eventuale libreria della piattaforma. Le interfacce \textbf{Request} e \textbf{Response} contengono le informazioni per la comunicazione. All'interno le informazioni sono già serializzate, mentre gli oggetti stessi verranno serializzati successivamente.

%HTTPS CLient

\begin{figure}[H]
    \includegraphics[scale=0.72]{Progettazione/Package/frontend/model/net/net_2.png}
    \centering
    \caption{net.vsdx}
\end{figure}

In figura si rappresenta la modalità di comunicazione con il middleware: si è introdotto \textbf{HTTPSClientInterface} che rappresenta il client che effettua le richieste al middleware. Si ha la possibilità di effettuare richieste in modo sincrono o asincrono, a seconda delle esigenze. Il canale di comunicazione \textbf{HTTPSInterface} viene fornito da \textbf{HTTPSBrokerInterface}, il quale si pone tra client e middleware.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel

\begin{figure}[H]
    \includegraphics[scale=0.75]{Progettazione/Package/frontend/viewmodel/viewmodel.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Come detto in precedenza, si utilizza il pattern \textbf{Observer} per il binding tra \textbf{View} e \textbf{ViewModel}. Si è aggiunta una classe \textbf{MutableData} per la gestione di un oggetto con osservatori esterni. La classe astratta \textbf{AbstractViewModel} rappresenta un ViewModel generale, dentro alla quale si trovano il client \textbf{HTTPSClientInterface} per effettuare le richieste e un \textbf{MutableData} per la risposta, la quale sarà osservata dalla view e si aggiornerà di conseguenza. \textbf{AbstractViewModel} implementa anche l'interfaccia \textbf{Listener}, nel caso sia neccessario effettuare delle richieste asincrone. I ViewModel \textbf{concreti} hanno lo stereotipo $<<$\textbf{ViewModel}$>>$, indicando che estendono \textbf{AbstractViewModel}.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.autenticazione

%Autenticazione Controller

\begin{figure}[H]
    \includegraphics[scale=0.80]{Progettazione/Package/frontend/viewmodel/viewmodel_autenticazione.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Vengono rappresentate in figura i ViewModel per le viste di autenticazione. Sono quindi previste le viste di login collegate a questi ViewModel. Quando la vista riceve l'evento di submit, essa invoca il suo ViewModel, il quale dopo una verifica dell'input, invia la richiesta al middleware. Si potrebbe migliorare il meccanismo di validazione dell'input in futuro, rendendolo più dinamico, utilizzando sempre il pattern \textbf{Observer} per effettuare un check di valutazione dinamico. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.utente

\begin{figure}[H]
    \includegraphics[scale=0.75]{Progettazione/Package/frontend/viewmodel/viewmodel_utente.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Nella figura viene presentato la parte di ViewModel dell'\textbf{utente}. Oltre ai metodi principali viene inserito anche \textbf{ScegliStaff}, per scegliere lo staff durante la sessione. Esiste un ViewModel associato ad una vista per visionare l'utente loggato ed effettuare eventualmente il logout. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.amministrazione

%Gestione Log Controller

\begin{figure}[H]
    \includegraphics[scale=0.75]{Progettazione/Package/frontend/viewmodel/viewmodel_amministrazione.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Sono presenti tutti i ViewModel per gestire l'\textbf{amministrazione}: esiste la possibilità di registrare un utente, sbloccare un utente, cambiare la password dell'amministratore e gestire i log. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.membro

\begin{figure}[H]
    \includegraphics[scale=0.80]{Progettazione/Package/frontend/viewmodel/viewmodel_membro.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Contiene semplici operazioni per la scelta dell'evento e per le statistiche del membro.  Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.pr

%Gestione Vendita Prevendite Controller

\begin{figure}[H]
    \includegraphics[scale=0.75]{Progettazione/Package/frontend/viewmodel/viewmodel_pr.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Il PR ha alcune viste per la \textbf{vendita di prevendite}. La generazione del documento viene fatta tramite il metodo \textbf{generaDocumento} che permette alla vista di mostrare il documento generato, da consegnare al cliente.  Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.cassiere

%Gestione Entrata Controller

\begin{figure}[H]
    \includegraphics[scale=0.90]{Progettazione/Package/frontend/viewmodel/viewmodel_cassiere.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

Per il cassiere serve solo il ViewModel per la \textbf{timbratura} e per la lista di prevendite entrate. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.viewmodel.amministratore

%Gestione Eventi Controller
%Gestione Tipologie Prevendita Controller
%Gestione Membri Controller


\begin{figure}[H]
    \includegraphics[scale=0.9]{Progettazione/Package/frontend/viewmodel/viewmodel_amministratore.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

In figura il ViewModel per cambiare il \textbf{codice di accesso} allo staff. L'interfaccia estende \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/viewmodel/viewmodel_amministratore_evento.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

In figura le ViewModel per la gestione di un \textbf{evento}. Alcune viste richiedono l'aggiunta di informazioni prima di eseguire l'operazione. Per esempio \textbf{AnnullaEventoViewModel} richiede la lista degli eventi tramite metodo \textbf{listaEventi}. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/viewmodel/viewmodel_amministratore_membri.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

In figura le ViewModel per la gestione dei \textbf{membri}. Alcune viste richiedono l'aggiunta di informazioni prima di eseguire l'operazione. Per esempio, prima di rimuovere un membro, ho bisogno di sapere la lista dei membri. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/viewmodel/viewmodel_amministratore_tipologia_prevendita.png}
    \centering
    \caption{viewmodel.vsdx}
\end{figure}

In figura le ViewModel per la gestione delle \textbf{tipologie di prevendita}. Alcune viste richiedono l'aggiunta di informazioni prima di eseguire l'operazione. Per esempio, prima di rimuovere un membro, ho bisogno di sapere la lista dei membri. Le interfacce estendono \textbf{Subject} per rendere possibile la registrazione della vista agli eventi.

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view.png}
    \centering
    \caption{view.vsdx}
\end{figure}

L'\textbf{AbstractView} serve per aggiungere un comportamento comune a tutte le view: il \textbf{binding} tra View e ViewModel, tramite il metodo bind e il metodo per effettuare il draw su schermo della vista. Di conseguenza la classe abstract implementa \textbf{Observer}, per restare aggiornato sul risultato presente nel ViewModel. Tutte le viste utilizzano lo stereotipo $<<$View$>>$ per indicare che estendono AbstractView.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.home

%Interfacce Home


\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/home.png}
    \centering
    \caption{home.vsdx}
\end{figure}

In figura sono rappresentate le schermate home. Non necessitano di una ViewModel, in quanto non fanno altro che richiamare altre viste. Si espone solo il layout di \textbf{GestioneUtenteHome} per non appesantire troppo il documento, essendo già notevolmente ricco.

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_home_utente.PNG}
    \centering
    \caption{layout\_home\_utente.png}
\end{figure}

Il layout è composto da un titolo per identificare la home e una serie di pulsanti per agire sulla vista desiderata. Alcuni pulsanti potrebbero portare ad altre home invece che alla vista finale.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.autenticazione

%Interfaccia Autorizzazione

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_autenticazione.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Le viste di autenticazione offrono la schermata per il login. Il layout delle due viste è completamente interoperabile. Le altre funzionalità del package autenticazione sono state spostate in altri gruppi di viste, a seconda di come risultasse più facile per l'utente finale. Una volta che il login ha avuto successo si sceglie la home specifica: per un utente normale \textbf{GestioneUtenteHome}, mentre per un amministratore di sistema \textbf{GestioneAmministrazioneHome}.

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_autenticazione.png}
    \centering
    \caption{layout\_autenticazione.png}
\end{figure}

Il layout è piuttosto semplicistico: composto da un form per la validazione delle credenziali e un pulsante di submit.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.utente

%Interfaccia Accedi staff
%Interfaccia Crea staff
%Interfaccia Cambia password

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_utente.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Sono fornite le viste generali per un utente. Utente View mostra le informazioni sull'utente corrente e la possibilità di effettuare il logout. Viene mostrata solo quest'ultima vista per non appesantire il documento:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_utente.PNG}
    \centering
    \caption{layout\_utente.png}
\end{figure}

Viene mostrato il nome, il cognome e il telefono. Inoltre è presente il pulsante per effettuare il logout.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.amministrazione

%Interfacce Gestione Log
%Interfacce Sblocco utente
%Interfacce Registra utente

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_amministrazione.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Contiene le viste per la gestione di amministrazione di sistema. A queste viste ha accesso solo l'amministratore di sistema. Permette la lettura del log e un'aggiunta ad esso. In seguito viene mostrato il layout di aggiunta di un record di log:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_aggiungi_record.PNG}
    \centering
    \caption{layout\_aggiungi\_record.png}
\end{figure}

Il layout mostra come è posssibile aggiungere la priorità al log e la descrizione. Il timestamp viene aggiunto automaticamente. Il pulsante aggiungi record permette l'aggiunta al log del sistema.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.membro

%Interaccia Visualizza statistiche personali

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_membro.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Il package membro fornisce delle viste generali per scegliere l'evento della sessione e visualizzare statistiche sul membro. Viene mostrato il layout di \textbf{ScegliEventoView}:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_scegli_evento.PNG}
    \centering
    \caption{layout\_scegli\_evento.png}
\end{figure}

Il layout rappresenta una lista di eventi che si possono scegliere, cliccandoci sopra. Il layout è applicabile anche a \textbf{ScegliStaffView}.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.pr

%Interfacce Gestione vendita prevendita

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_pr.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Il package pr contiene le viste per la gestione vendita prevendita. Consente di aggiungere una prevendita, annullare una prevendita e rimborsare una prevendita. \textbf{AggiungiPrevenditaView} ha un metodo per il draw del documento digitale. Viene mostrato il layout AggiungiPrevenditaView e un esempio di documento digitale QR Code:

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/layout/layout_aggiungi_prevendita.PNG}
    \centering
    \caption{layout\_aggiungi\_prevendita.png}
\end{figure}

Il layout permette di inserire il nome e il cognome del cliente e di aggiungere la tipologia di prevendita. Il pulsante aggiungi prevendita permette di effettuare l'operazione.

\begin{figure}[H]
    \includegraphics[scale=0.2]{Progettazione/esempio_documento.png}
    \centering
    \caption{layout\_esempio\_documento.png}
\end{figure}

Si tratta di un documento digitale formato da un QR Code e una descrizione. Il documento potrebbe essere implementato in un'altra forma, ma il codice QR è preferibile, in quanto permette di effettuare una scansione rapida della prevendita.

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.cassiere

%Interfacce Gestione entrata

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_cassiere.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Le viste del cassiere permettono la timbratura di una prevendita durante l'evento e la visione delle prevendite che sono entrate all'evento, per un controllo manuale. Contiene il metodo \textbf{leggiDocumento} per effetuare la scansione del documento. Viene mostrata la vista di timbratura della prevendita:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_timbra_prevendita.PNG}
    \centering
    \caption{layout\_timbra\_prevendita.png}
\end{figure}

Si può vedere che nell'esempio la vista utilizza la camera per la lettura del QR Code visto nell'esempio precedente. Ovviamente il codice QR è a titolo di esempio, ma fortemente consigliato di applicarlo nell'implementazione.

\newpage

\paragraph{Package} it.unibo.prevenditaelettronica.frontend.view.amministratore

%Interfacce Gestione Membri
%Interfacce Gestione Tipologie Prevendita
%Interfacce Gestione Eventi
%Interfacce Cambia codice accesso
%Interfacce Visualizza Statistiche

Abbiamo spezzato il package in più diagrammi vista la complessità. Anche qui vengono mostrate solo alcune viste.


\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_amministratore.png}
    \centering
    \caption{view.vsdx}
\end{figure}

La vista permette di cambiare codice di accesso allo staff. Qui il layout proposto per la vista:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_cambia_codice.PNG}
    \centering
    \caption{layout\_cambia\_codice.png}
\end{figure}

Si ha un input per inserire i codici e un submit per effettuare l'operazione.

\newpage

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_amministratore_evento.png}
    \centering
    \caption{view.vsdx}
\end{figure}

Qui vengono mostrate le viste per la gestione degli eventi. Viene mostrata la vista di statistiche dell'evento:

\begin{figure}[H]
    \includegraphics[scale=0.6]{Progettazione/Package/frontend/view/layout/layout_statistiche_evento.png}
    \centering
    \caption{layout\_statistiche\_evento.png}
\end{figure}

Viene mostrato un titolo, i quadagni e le entrate svolte per l'evento.

\newpage

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_amministratore_membri.png}
    \centering
    \caption{view.vsdx}
\end{figure}

In figura le viste per la gestione dei membri dello staff. Viene mostrato il layout della lista dei membri:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_lista_membri.PNG}
    \centering
    \caption{layout\_lista\_membri.png}
\end{figure}

Si tratta di una lista con le informazioni di ogni membro: nome, cognome e telefono.

\newpage

\begin{figure}[H]
    \includegraphics[scale=0.85]{Progettazione/Package/frontend/view/view_amministratore_tipologie_prevendita.png}
    \centering
    \caption{view.vsdx}
\end{figure}

In figura le viste per la gestione delle tipologie prevendita dell'evento scelto. Viene mostrato il layout della lista delle tipologie prevendita dell'evento scelto:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Package/frontend/view/layout/layout_lista_tipologie_prevendita.PNG}
    \centering
    \caption{layout\_lista\_tipologie\_prevendita.png}
\end{figure}

La lista prevede il nome della tipologia, il suo periodo di vendita e il prezzo di vendita.

\newpage

\subsubsection{Interazione}

\paragraph{Autenticazione Utente} Viene mostrato il diagramma di interazione tra utente, front-end, middleware e database per l'autenticazione dell'utente. Viene mostrato il funzionamento del pattern \textbf{Observer}, della richiesta \textbf{Asincrona} e della gestione della sessione a livello \textbf{middleware}.

%TODO: da chiedere se i messaggi callback sono restituiti o normali

\begin{figure}[H]
    \includegraphics[angle=90,scale=0.55]{Progettazione/Interazione/diagramma_sequenza_autenticazione_utente.pdf}
    \centering
    \caption{diagramma\_sequenza\_autenticazione\_utente.vsdx}
\end{figure}

\newpage

\subsubsection{Comportamento}

I diagrammi di stato principali sono presenti nella sezione Analisi. Qui si mostra l'algoritmo utilizzato da \textbf{HTTPSBrokerInterface} per scegliere il servizio middleware, tramite diagramma di flusso:

\begin{figure}[H]
    \includegraphics[scale=1]{Progettazione/Comportamento/diagramma_algoritmo_broker.png}
    \centering
    \caption{diagramma\_algoritmo\_broker.vsdx}
\end{figure}

Il diagramma di flusso mostra il broker che esegue la ricerca del canale per \textbf{priorità}. Quella più bassa è quella fornita dal servizio locale posto nell'evento in caso di attacco DoS in corso.

\newpage

\subsection{Persistenza}

\subsubsection{Schema ER}

\begin{figure}[H]
    \includegraphics[scale=0.65]{Progettazione/schemaER.PNG}
    \centering
    \caption{Progetto\_Ing\_Software\_ER.lun}
\end{figure}

\paragraph{Entità} Le chiavi primarie (\textbf{id}) sono di tipo intero ed autoincrement, per semplificare l'utilizzo del pattern DAO:

\begin{itemize}
    \item \textbf{Utente}: rappresenta un utente nel sistema. \textbf{tentativiLogin} serve per rispettare il vincolo \hyperlink{R28NF}{R28NF}. L'attributo \textbf{username} deve essere univoco. La password viene salvata come salted hash, con meccanismo di hashing sicuro (SHA256 o superiore). La tecnica salting serve per contrastare la tecnica di attacco \textbf{Rainbow Tables}. Le stesse considerazioni vanno fatte per l'entità \textbf{Amministratore di sistema}.
    \item \textbf{Membro}: rappresenta un membro di uno staff. I ruoli sono modellati come sotto entità. Nel caso il membro perda il ruolo, le iterazioni del membro devono rimanere.
    \item \textbf{Prevendita}: gli stati della prevendita sono modellati come sotto-entità di prevendita. \textbf{codice} serve per rispettare il vincolo \hyperlink{R27NF}{R27NF}.
    \item \textbf{Evento}: gli stati del'evento sono modellati come sotto-entità di evento. Gli attributi \textbf{inizio} e \textbf{fine} rappresentano il periodo temporale in cui è in corso l'evento (\hyperlink{R18F}{R18F}).
    \item \textbf{Amministratore di sistema}: entità a sé stante, l'\textbf{username} deve essere univoco.
    \item \textbf{Tipologia Prevendita}: gli attributi \textbf{aperturaVendite} e \textbf{chiusuraVendite} rappresentano il periodo temporale in cui è possibile vendere le prevendite (\hyperlink{R20F}{R20F}). Questo periodo deve essere logicamente antecedente al periodo di svolgimento dell'evento (\hyperlink{R9NF}{R9NF}).
    \item \textbf{Utente Bloccato}: ci vuole un trigger che controlli \textbf{tentativiLogin}.
\end{itemize}


\paragraph{Relazioni} Anche qui vengono mostrate in elenco solo le relazioni più importanti:
\begin{itemize}
    \item \textbf{Membro}: In origine era una relazione molti a molti tra \textbf{utente} e \textbf{staff} per associare l'utente allo staff. Viene scomposta nell'entità \textbf{Membro} per riuscire a modellare i ruoli.
    \item \textbf{Crea Staff}: quando si crea lo staff, si diviene anche amministratore (\hyperlink{R21NFbis}{R21NFbis}).
\end{itemize}

\paragraph{Trigger} Vengono inclusi trigger per far rispettare i vincoli:

\begin{itemize}
    \item \textbf{Evento}: controllo che il periodo di svolgimento sia valido (inizio $<$ fine, periodo nel futuro), lo stato dell'evento deve rispettare il diagramma di comportamento.
    \item \textbf{Tipologia Prevendita}: controllo che il periodo di vendita sia valido (inizio $<$ fine, periodo nel futuro). Se sono state vendute prevendite non posso eliminare o modificare la tipologia (\hyperlink{R16NF}{R16NF}).
    \item \textbf{Prevendita}: consistenza dell'evento e della tipologia di prevendita. La data di vendita deve essere conforme con il periodo di vendita. L'evento deve essere valido per l'inserimento. Lo stato della prevendita deve rispettare il diagramma di comportamento.
    \item \textbf{Prevendita Timbrata}: Inserimento effettuato nel periodo dell'evento, l'evento deve essere valido e la prevendita deve essere valida e non annullata.
    \item \textbf{Membro}: Verifica del requisito \hyperlink{R14F/NF}{R14F/NF}.
    \item \textbf{Utente}: Verifica unicità username, un utente può creare al massimo uno staff.
\end{itemize}

\paragraph{Protezione della persistenza del database} Essendo il database gestito su una macchina isolata remota, il rischio di accesso non autorizzato è limitato. Si consiglia di limitare l'accesso ai soli ip dello strato middleware.\\Per migliorare ulteriormente la sicurezza, si consiglia di spostare l'entità amministratore di sistema in un RDMBS separato.

\paragraph{Viste} Un'ulteriore aggiunta, alla sicurezza e alla semplificazione della logica di business, può essere l'introduzione di viste di accesso al database:

\begin{center}
    \begin{tabularx}{1\textwidth}{|X|X|X|}
        \hline
        \textbf{Vista} & \textbf{Entità} & \textbf{Accesso}\\
        \hline
        \hline
        Amministratore di Sistema & Amministratore Di Sistema & Lettura/Scrittura\\
        Amministratore di Sistema & Utente & Lettura/Scrittura\\
        Utente & Utente & Lettura/Scrittura\\
        Utente & Staff & Lettura/Scrittura\\
        Utente & Evento & Lettura/Scrittura\\
        Utente & Membro & Lettura/Scrittura\\
        Utente & Tipologia Prevendita & Lettura/Scrittura\\
        Utente & Prevendita & Lettura/Scrittura\\
        Utente & Statistiche Membro & Lettura\\
        Utente & Statistiche Evento & Lettura\\
        \hline
    \end{tabularx}
\end{center}

\paragraph{Integrità della persistenza del database} Si devono effettuare transazioni dove necessario, con dovuti \textbf{savepoint} e \textbf{rollback} in caso di errore, evitando stati non consistenti del database.

\subsubsection{Formato del file del log}

Il file di log deve contenere informazioni utili per l'amministratore di sistema. Sono raccolte molte operazioni svolte, soprattutto quelle ritenute importanti. L'amministratore di sistema può aggiungere note personali.

\begin{lstlisting}
    <timestamp> <livello> <descrizione>
    <timestamp> <livello> <descrizione>
    <timestamp> <livello> <descrizione>
    <timestamp> <livello> <descrizione>
\end{lstlisting}

\paragraph{Protezione della persistenza dei log} Essendo il file salvato nel livello middleware, il rischio di accesso di malintenzionati si riduce, ma per migliorare la protezione, bisogna impostare i giusti permessi utente nel file system. Ovviamente solo l'amministratore di sistema può accedere a queste informazioni.

\newpage

\subsection{Collaudo}

Data la natura multi-layer non prevista nella sezione di analisi, sono stati introdotti specifici test sia per il layer di front-end, sia per il layer di middleware. I test introdotti sono molti, ma vengono mostrati solo due test, uno per lo strato di middleware e un altro per lo strato front-end.

\lstinputlisting[language=Java]{Progettazione/Test/TestHTTPSBroker.java}
\lstinputlisting[language=Java]{Progettazione/Test/TestJSONPrinter.java}

\newpage

\subsection{Deployment}

Il deployment del sistema avviene in due modi separati, a seconda del layer middleware o front-end. Il deployment dello strato intermedio viene gestito dall'amministratore di sistema, egli si occupa anche della procedura di aggiornamento. A seconda dell'implementazione, verrà distribuito all'amministratore di sistema un pacchetto automatico o manuale per l'aggiornamento del sistema. Per il deployment lato front-end sarà previsto un check automatico da parte del client. In caso di aggiornamento, viene mostrato un pop-up all'utente:

\begin{figure}[H]
    \includegraphics[scale=0.5]{Progettazione/aggiornamento_dialog.png}
    \centering
    \caption{aggiornamento\_dialog.png}
\end{figure}


\newpage

\section{Implementazione}

\subsection{Scelte tecnologiche}

Nella fase di implementazione abbiamo deciso di implementare lo strato di persistenza utilizzando il RDBMS MySQL, mentre lo strato middleware viene implementato usando il linguaggio PHP 7. Abbiamo deciso di implementare lo strato front-end suddividendolo in tre client, uno web-based per la gestione di amministrazione di sistema, un altro web-based per l'amministrazione dello staff e infine un client mobile sviluppato sotto la piattaforma Android per il cassiere e il pr, dato che il loro lavoro viene fatto in vari ambienti. La scelta di queste tecnologie è pensata per risolvere il requisito \hyperlink{R5NF}{R5NF}. Infatti la maggior parte delle soluzioni hosting gratuite offre queste tecnologie di default. La scelta di Android invece che l'utilizzo di iOS è dovuta sempre per lo stesso motivo: per sviluppare con iOS serve hardware proprietario. Android adotta Java come linguaggio di sviluppo. I client web-based sono implementati mediante una combinazione di HTML+CSS+Javascript, con varie librerie come JQuery e Bootstrap, utilizzando la tecnica AJAX per le chiamate allo strato middleware. I client web-based si trovano nello stesso spazio di hosting dello strato middleware.

\subsection{Scelte Implementative}

\begin{itemize}
    \item Ridotto enumeratore ServicePriority da PRIMARY, BACKUP, LOCAL a PRIMARY, LOCAL. Il servizio di hosting non espone il database all'esterno e quindi non è possibile replicare lo strato middleware.
    \item Package DAO del middleware implementato usando PDO, che supporta molti rdbms.
    \item Utilizzo di chiavi surrogate per identificare gli oggetti, anche a lato client.
    \item Implementazione della Sessione mediante sessione gestita da PHP.
    \item Nel client Android, viene usata la libreria Volley come HTTPSClient.
    \item Nel client Android viene usata la libreria GSON per la serializzazione/deserializzazione delle informazioni. Le interfacce JSONSerializable e JSONDeserializable diventano superflue utilizzando la libreria.
    \item Nel database le credenziali vengono salvate come coppia (username, salted hash), utilizzando come algoritmo di hashing SHA256.
    \item Nello strato middleware, l'interfaccia HTTPSInterface è superflua, in quanto la comunicazione HTTPS è intrinseca nel linguaggio PHP.
    \item Il certificato HTTPS viene fornito dal servizio di hosting.
    \item Nello strato middleware non c'è bisogno delle interfacce JSONSerializable e JSONDeserializable, in quanto viene usata la libreria integrata nel linguaggio.
    \item Per rendere sicuro la cartella dei log è stato utilizzato un file .htaccess, per restringerne l'accesso.
    \item I client web-based non hanno bisogno dell'interfaccia HTTPClient, in quanto utilizzano il browser stesso.
    \item I client web-based non utilizzano il broker in quanto il servizio di replicazione non è necessario per le funzionalità dei client web-based.
    \item I client web-based non hanno bisogno delle interfacce JSONSerializable e JSONDeserializable, in quanto viene usata la libreria integrata nel browser.
    \item HTTPSBroker è stato implementato in maniera diversa: il broker fornisce solo gli URL, è HTTPSClient a verificare lo stato del servizio, e in caso fosse necessario, richiede l'URL alternativo al broker.
    \item Non è stato possibile separare l'entità Utente e l'entità AmministratoreDiSistema in due database distinti, neppure un accesso al database con autorizzazioni diverse. Il servizio di hosting offre un solo database con credenziali di accesso uniche.
    \item Come consigliato, abbiamo scelto di utilizzare la tecnologia QRCode come documento digitale. Per la consegna al cliente viene mandato direttamente la foto, oppure un link dove è possibile generare il QRCode sul momento.
    \item Viene aggiunta una vista nel client Android per aggiungere l'URL del servizio replicato in locale.
    \item Per replicare il servizio in locale, l'amministratore di sistema esegue un backup del database mediante l'interfaccia fornita dal servizio di hosting, e utilizzando il software XAMPP replica il servizio. I client dovranno aggiungere il servizio tramite il broker.
    \item Si è deciso di ampliare le statistiche, catalogandole per tipologia di prevendita.
    \item Nel client Android abbiamo modificato alcuni ViewModel del front-end, rendendoli osservatori dei form delle viste, per rendere la validazione dell'input in tempo reale.
    \item Le connessioni al database sono sincronizzate con il fuso orario dello strato middleware e dati temporali ricevuti e inviati ai client sono formattati con standard \textbf{ISO8601}: così facendo, si rende l'applicativo utilizzabile in un contesto globale.
\end{itemize}

\subsection{Collaudo}

Il collaudo su middleware è stato integrato mediante libreria PHPUnit. Nel client Android viene usata la libreria JUnit, integrata nell'ambiente di sviluppo. Per testare il codice Javascript, presente nei client web-based abbiamo deciso di implementare i test senza l'ausilio di librerie esterne, ma utilizzando il Web Developer Kit per monitorare il codice di testing.

\newpage

\section{Deployment}

\subsection{Note di configurazione sul middleware}

Il servizio middleware deve essere configurato dall'amministatore di sistema, configurando l'accesso al database:


\lstinputlisting[language=PHP]{Implementazione/config.php}


\subsection{Note di configurazione sul front-end}

I client web-based sono configurati dall'amministratore di sistema, in quanto sono salvati nello spazio di hosting che ospita anche lo strato middleware:

\lstinputlisting[language=PHP]{Implementazione/config.js}

Il client Android richiede solamente di inserire l'URL del servizio middleware, fornito dall'amministratore di sistema.

\subsection{Artefatti}

%Chiedere se va bene OK

\begin{figure}[H]
    \includegraphics[scale=0.7]{Implementazione/artefatti.png}
    \centering
    \caption{artefatti.vsdx}
\end{figure}

\newpage

%chiedere se va bene OK
%da chiedere se aggiungere db, php, apache NO

\subsection{Deployment Type-Level}

\begin{figure}[H]
    \includegraphics[scale=1]{Implementazione/type_deployment.png}
    \centering
    \caption{type\_deployment.vsdx}
\end{figure}


\end{document}
